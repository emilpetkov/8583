module ISO8583

  def self.add_value2text(deserialization_map, value2text_map, string_id)
    return unless value2text_map
    value = deserialization_map[string_id]
    return unless value
    value_info_text = value2text_map[value]
    return unless value_info_text
    text_string_id = "#{string_id}_value2text"
    deserialization_map[ text_string_id ] = value_info_text
  end

  def self.serialize_fixed_subfields(field_number, string_id2subfield, params_hashtable, message)
    identified_subfields = 0
    field_raw_data = ""

    index = 0

    ignore_rest_message_part = false

    string_id2subfield.keys.sort_by { |key| string_id2subfield[key].start_position }.each do
      |subfield_string_id|

      if( index != string_id2subfield[subfield_string_id].start_position )
        raise ArgumentError.new "BM #{field_number}: serializer dont know what data to put on position #{index}. There is a gap in subfields definitions. Next position with definition is #{string_id2subfield[subfield_string_id].start_position}"
      end
      subfield_def = string_id2subfield[ subfield_string_id ]
      subfield_value = params_hashtable[subfield_string_id]
      if( not subfield_value )
        if( subfield_def.mandatory )
          raise ArgumentError.new "BM #{field_number}: Element #{subfield_string_id} is missing from map with values, but it is marked as mandatory"
        end
        # no value & field not mandatory
        index += subfield_def.subfield_length
        ignore_rest_message_part = true
        next
      else
        if( ignore_rest_message_part )
          # we have subfield_value and we are in ignore_rest_message_part mode
          raise ArgumentError.new "BM #{field_number}: Subfield #{subfield_string_id} is filled, but previous subfield was empty, so we could generate an array with gaps"
        else
          # everything is normal here
        end
      end
      encoded_subfield = subfield_def.serialize( subfield_value )

      identified_subfields += params_hashtable[subfield_string_id.to_s+"_value2text"] ? 2 : 1
      field_raw_data += encoded_subfield
      index += subfield_def.subfield_length
     end

    if( identified_subfields != params_hashtable.length )
        raise ArgumentError.new "BM #{field_number} arguments hashmap has unparsed elements. Identified subfields '#{identified_subfields}'. Elements in hashmap: #{params_hashtable.length}"
    end

    field_raw_data
  end

  def self.deserialize_fixed_subfields(field_number, string_id2subfield, raw_src, message)
    result_hashmap = Hash.new
    index = 0
    string_id2subfield.keys.sort_by { |key| string_id2subfield[key].start_position }.each do |subfield_string_id|
      if( index != string_id2subfield[subfield_string_id].start_position )
        raise ArgumentError.new "BM #{field_number}: deserializer dont know what data is lcoated on position #{index}. There is a gap/overlapse in subfields definitions."
      end
      subfield_def = string_id2subfield[ subfield_string_id ]
      if( not subfield_def )
        raise ArgumentError.new "BM #{field_number}: cannot find definition for element #{subfield_string_id}."
      end
      raw_subfield_value = raw_src[ index, subfield_def.subfield_length ]
      subfield_length = subfield_def.deserialize( result_hashmap, raw_subfield_value )
      index += subfield_length
    end
    result_hashmap
  end

  def self.serialize_lllxx_subfields(field_number, string_id2subfield, params_hashtable, message)
    identified_subfields = 0
    field_raw_data = ""

    params_hashtable.keys.sort_by { |key| key.to_s }.each do
      |subfield_string_id|
      subfield_value = params_hashtable[subfield_string_id]
      subfield_def = string_id2subfield[ subfield_string_id ]
      if( subfield_def == nil )
        raise ArgumentError.new "BM #{field_number} Unknown subfield with id '#{subfield_string_id}' and value '#{subfield_value.to_s}'"
      end
      encoded_subfield = subfield_def.serialize( subfield_value )

      identified_subfields += 1
      field_raw_data = field_raw_data + encoded_subfield
     end

    if( identified_subfields != params_hashtable.length )
        raise ArgumentError.new "BM #{field_number} arguments hashmap has unparsed elements. Identified subfields '#{identified_subfields}'. Elements in hashmap: #{params_hashtable.length}"
    end

    field_raw_data
  end

  def self.deserialize_lllxx_subfields(field_number, numeric_id2subfield, raw_src, message)
    result_hashmap = Hash.new
    index = 0
    while index != raw_src.length
      if( (raw_src.length - index) < 5 )
        raise ArgumentError.new "BM #{field_number}, the rest of the raw data is 1 byte, so we cannot get field_id"
      end
      rest = raw_src[ index .. raw_src.length - 1 ]
      subfield_id = raw_src[index+3 .. index+4].to_i
      subfield_def = numeric_id2subfield[ subfield_id ]

      if( subfield_def == nil )
        raise ArgumentError.new "BM #{field_number} Unknown subfield with id '#{subfield_id}', index='#{index}', rest='#{rest}'"
      end

      subfield_length = subfield_def.deserialize( result_hashmap, rest  )
      index += subfield_length # 2 is for the prefix
    end # while

    result_hashmap
  end

  def self.serialize_lll_ebcdic_subfield(additional_data)
    "".force_encoding('ASCII-8BIT').tap do |serialized_string|
      additional_data.each do |name, data|
        # subfield number
        number      = PAYNETICS_SUBFIELD_DEFINITIONS[name][:number]
        subelements = PAYNETICS_SUBFIELD_DEFINITIONS[name][:subelements]
        if subelements.present? && data.is_a?(Hash)
          data.each do |subelement_name, subelement_data|
            length            = number.length
            subelement_number = subelements[subelement_name][:number]
            subelement_length = (subelement_number + subelement_data).length
            serialized_string << "".force_encoding('ASCII-8BIT').tap do |enc_data_with_subelement|
              # length of the subfield = subfield number length + subelement length + length of the subelement length /const 00X, X = subelement length/
              enc_data_with_subelement << LLL_EBCDIC.encode(length + subelement_length + PAYNETICS_SUBFIELD_LENGTH_PREFIX, nil)
              enc_data_with_subelement << LL_EBCDIC.encode(number, nil)
              enc_data_with_subelement << LLL_EBCDIC.encode(subelement_length, nil)
              enc_data_with_subelement << LL_EBCDIC.encode(subelement_number, nil)
              enc_data_with_subelement << subelements[subelement_name][:codec].encode(subelement_data)
            end
          end
        else
          # Encode the length of subfield number + data in EBCDIC
          length = LLL_EBCDIC.encode((number + data).length, nil)
          # Encode the subfield number in EBCDIC
          number = LL_EBCDIC.encode(number, nil)
          # Encode the actual data in the format
          data = PAYNETICS_SUBFIELD_DEFINITIONS[name][:codec].encode(data)
          # Join the encoded length, encoded subfield number and actual data
          encoded_data = length + number + data
          serialized_string << encoded_data
        end
      end
    end
  end

  def self.deserialize_lll_ebcdic_subfield(raw_additional_data)
    #\xF0\xF0\xF4 \xF4\xF0\xF0\xF7 \xF0\xF0\xF6 \xF3\xF0\xF0\xF2\xF9\xF9
    # Algorithm to iterate over the serialized fields. Each iteration loops over
    # one serialized field
    {}.tap do |deserialized_fields|
      index = 0
      length_prefix = PAYNETICS_SUBFIELD_LENGTH_PREFIX
      while index < raw_additional_data.length
        # Get the length of the field
        length = ISO8583.ebcdic2ascii(raw_additional_data[index...index + length_prefix]).to_i
        # Get the encoded payload of the field
        data = raw_additional_data[(index + length_prefix)...(index + length_prefix + length)]

        field_number = ISO8583.ebcdic2ascii(data[0, PAYNETICS_SUBFIELD_NUMBER_LENGTH]).to_i
        field_definition = PAYNETICS_SUBFIELD_DEFINITIONS.values.detect { |k, _v| k[:number].to_i == field_number }

        subelements = field_definition[:subelements]
        if subelements.present?
          data_index = 0
          sub_data = data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, data.length]
          while data_index < sub_data.length
            subelement_length     = ISO8583.ebcdic2ascii(sub_data[data_index...data_index + length_prefix]).to_i
            subelement_data       = sub_data[(data_index + length_prefix)...(data_index + length_prefix + subelement_length)]
            subelement_number     = ISO8583.ebcdic2ascii(subelement_data[0, PAYNETICS_SUBFIELD_NUMBER_LENGTH]).to_i
            subelement_definition = subelements.values.detect { |k, _v| k[:number].to_i == subelement_number }
            actual_data           = subelement_definition[:codec].decode(subelement_data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, subelement_data.length])

            deserialized_fields["#{field_definition[:name]}/#{subelement_definition[:name]}"] = actual_data

            data_index += actual_data.length + length_prefix + PAYNETICS_SUBFIELD_NUMBER_LENGTH
          end
        else
          # Decode the payload with the proper codec
          actual_data = field_definition[:codec].decode(data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, data.length])
          # Add the deserialized field to the response object
          deserialized_fields[field_definition[:name]] = actual_data
        end
        # Get the total length of the field and add it to the index for the next iteration
        subfield_length = data.length + length_prefix
        index += subfield_length
      end
    end
  end

  def self.array_to_hashmap_fixed_len(hashmap, hashmap_id, raw_array, start_pos, data_len, field_info)
    if raw_array.length < (start_pos + data_len)
      raise ArgumentError.new("#{field_info}: No space in raw array to src value, arr_len=#{raw_array.length}, data_end_pos=#{start_pos + data_len}")
    end
    hashmap[hashmap_id] = raw_array[start_pos..(start_pos + data_len - 1)]
    start_pos + data_len
  end

  def self.value_to_array(src, raw_array, start_pos, data_len, field_info, mandatory)
    if raw_array.length < (start_pos + data_len)
      raise ArgumentError.new("#{field_info}: No space in raw array to src value, arr_len=#{raw_array.length}, data_end_pos=#{start_pos + data_len}")
    end

    unless src or src.length < 1
      if mandatory
        raise ArgumentError.new("#{field_info}: mandatory field is not filled")
      else
        # just skipping
        return
      end
    end

    if src.length != data_len
      raise ArgumentError.new("#{field_info}: src_field_length=#{src.length}; dst_field_length=#{data_len}; src='#{src}'")
    end

    raw_array[start_pos..(start_pos + data_len - 1)] = src
  end

  def self.xx_value_to_array(raw_array, data_len, subfield_num_id1, subfield_str_id1, field_info1, mandatory)
    if (not raw_array) && (not mandatory)
      return ""
    end

    if( subfield_num_id1 < 0 || subfield_num_id1 > 99 )
      raise ArgumentError.new("#{field_info1} (subfield_id=#{subfield_num_id1}/#{subfield_str_id1}): subfield_id is not in range 00-99")
    end

    subfield_id2 = (subfield_num_id1 < 10 ? "0" : "") + subfield_num_id1.to_s

    field_info2 = (field_info2 ? field_info2 + " " : "") + "(subfield_id=#{subfield_num_id1}/#{subfield_str_id1})"

    if data_len != raw_array.length
      raise ArgumentError.new("#{field_info1} (subfield_id=#{subfield_num_id1}/#{subfield_str_id1}): provided data length(#{raw_array.length}) differs from required length(#{data_len}). Value is '#{raw_array}'")
    end

    subfield_id2 + raw_array
  end

  # TODO - this is crap, needs to use the bin list
  def self.credit_card_brand(number)
    digits = number.to_s[0..5].to_i
    case digits
      when 350000..359999, 334021, 310000, 213100..213199
        'jcb'
      when 558345..559999, 557993..558343, 557713..557991, 554564..557711, 553104..554562,
        551000..553102, 548855..550998, 534096..548853, 523097..534094, 510000..523095,
        229240..272099, 222100..229236
        'master'
      when 390000, 389925, 389919, 389854, 389820..389821, 389614, 389533, 389496,
        389490, 389389, 389283, 389249, 389183, 389151..389152, 389035, 388999,
        388961, 388922, 388893, 388831, 388823, 388797, 388750, 388712, 388681,
        388658, 388650, 388642, 388594, 388574..388579, 388554, 388549, 388526,
        388507, 388502, 388500, 388467, 388455, 388429, 388403, 388380, 388294,
        388288, 388153, 388150, 388121, 388106, 388099, 388080, 388010, 387999,
        387900, 387830, 387815, 387805, 387800, 387748, 387744, 387715, 387674,
        387614, 387601, 387501, 387483, 387467, 387421, 387401, 387398, 387368,
        387363, 387330, 387280, 387248, 387208, 386999, 386990, 386830..386831,
        386819, 386767, 386759, 386726, 386628, 386502, 386457, 386436, 386273,
        386208, 386183, 386172, 386163, 386136, 386098, 386080, 386062, 385999..386000,
        385987, 385928, 385878, 385841, 385716, 385660, 385598, 385591, 385576,
        385546, 385490, 385463, 385446, 385437, 385365, 385283, 385207, 385200..385201,
        385181, 385153, 385085, 385062, 385048, 385030, 385026, 385020, 385002..385003,
        384999..385000, 384988, 384943, 384930, 384920, 384899, 384868, 384830,
        384783, 384777, 384699, 384669..384670, 384622, 384599, 384546, 384499,
        384430, 384399, 384384, 384358, 384336, 384328, 384250..384251, 384225,
        384170, 384120, 384109..384110, 384102, 384096, 384015, 383999..384000,
        383932, 383799, 383758, 383736, 383371, 383356, 383353, 383228, 383182,
        383153, 382999..383001, 382980, 382965, 382944, 382886, 382814, 382797..382799,
        382794, 382792, 382790, 382773, 382764, 382750, 382737, 382702, 382699,
        382674, 382528, 382503, 382499, 382457, 382335, 382299, 382284, 382199,
        382105, 382033, 381999, 381935, 381815, 381750, 381741, 381559, 381537,
        381424, 381379, 381226, 381200, 381185, 381134, 381026, 381024, 380999..381000,
        380989, 380971, 380902, 380899, 380804, 380787, 380727, 380714, 380546,
        380537, 380511, 380505..380507, 380499, 380393, 380208, 380174, 380172,
        380166, 380126, 380099, 380089..380095, 380059, 380054, 380046, 380039,
        380020, 360000..369999, 330280..333601, 330010..330060, 328186..329794,
        324222..328000, 320639..323866, 320000..320523, 317215..319696, 316123..317155,
        314711..315616, 312319..313838, 309500..309599, 300000..305999
        'diners'
      when 370000..379999, 337912..349999, 324000
        'amex'
      when 657351..659999, 657340..657349, 657334..657338, 657328..657330, 657326,
        657324, 657321..657322, 657319, 657307..657310, 657304..657305, 657040..657302,
        657033..657038, 657021..657030, 657019, 657017, 655921..657015, 655919,
        655917, 655851..655915, 655840..655849, 655833..655838, 655826..655830,
        655824, 655821..655822, 655819, 655813, 655807..655810, 655804..655805,
        655651..655802, 655640..655649, 655634..655638, 655626..655630, 655624,
        655621..655622, 655619, 655613..655614, 655607..655610, 655604..655605,
        654251..655602, 654240..654249, 654233..654238, 654226..654230, 654224,
        654221..654222, 654216..654219, 654213..654214, 654207..654210, 654204..654205,
        654151..654202, 654140..654149, 654134..654138, 654126..654130, 654124,
        654121..654122, 654118..654119, 654113..654114, 654107..654110, 654104..654105,
        644000..654102, 601300, 601100..601199, 390001..399999, 389926..389999,
        389920..389924, 389855..389918, 389822..389853, 389615..389819, 389534..389613,
        389497..389532, 389491..389495, 389390..389489, 389284..389388, 389250..389282,
        389184..389248, 389153..389182, 389036..389150, 389000..389034, 388962..388998,
        388923..388960, 388894..388921, 388832..388892, 388824..388830, 388798..388822,
        388751..388796, 388713..388749, 388682..388711, 388659..388680, 388651..388657,
        388643..388649, 388595..388641, 388580..388593, 388555..388573, 388550..388553,
        388527..388548, 388508..388525, 388503..388506, 388501, 388468..388499,
        388456..388466, 388430..388454, 388404..388428, 388381..388402, 388295..388379,
        388289..388293, 388154..388287, 388151..388152, 388122..388149, 388107..388120,
        388100..388105, 388081..388098, 388011..388079, 388000..388009, 387901..387998,
        387831..387899, 387816..387829, 387806..387814, 387801..387804, 387749..387799,
        387745..387747, 387716..387743, 387675..387714, 387615..387673, 387602..387613,
        387502..387600, 387484..387500, 387468..387482, 387422..387466, 387402..387420,
        387399..387400, 387369..387397, 387364..387367, 387331..387362, 387281..387329,
        387249..387279, 387209..387247, 387000..387207, 386991..386998, 386832..386989,
        386820..386829, 386768..386818, 386760..386766, 386727..386758, 386629..386725,
        386503..386627, 386458..386501, 386437..386456, 386274..386435, 386209..386272,
        386184..386207, 386173..386182, 386164..386171, 386137..386162, 386099..386135,
        386081..386097, 386063..386079, 386001..386061, 385988..385998, 385929..385986,
        385879..385927, 385842..385877, 385717..385840, 385661..385715, 385599..385659,
        385592..385597, 385577..385590, 385547..385575, 385491..385545, 385464..385489,
        385447..385462, 385438..385445, 385366..385436, 385284..385364, 385208..385282,
        385202..385206, 385182..385199, 385154..385180, 385086..385152, 385063..385084,
        385049..385061, 385031..385047, 385027..385029, 385021..385025, 385004..385019,
        385001, 384989..384998, 384944..384987, 384931..384942, 384921..384929,
        384900..384919, 384869..384898, 384831..384867, 384784..384829, 384778..384782,
        384700..384776, 384671..384698, 384623..384668, 384600..384621, 384547..384598,
        384500..384545, 384431..384498, 384400..384429, 384385..384398, 384359..384383,
        384337..384357, 384329..384335, 384252..384327, 384226..384249, 384171..384224,
        384161..384169, 384141..384159, 384121..384139, 384111..384119, 384103..384108,
        384101, 384097..384099, 384016..384095, 384001..384014, 383933..383998,
        383800..383931, 383759..383798, 383737..383757, 383372..383735, 383357..383370,
        383354..383355, 383229..383352, 383183..383227, 383154..383181, 383002..383152,
        382981..382998, 382966..382979, 382945..382964, 382887..382943, 382815..382885,
        382800..382813, 382795..382796, 382793, 382791, 382774..382789, 382765..382772,
        382751..382763, 382738..382749, 382703..382736, 382700..382701, 382675..382698,
        382529..382673, 382504..382527, 382500..382502, 382458..382498, 382336..382456,
        382300..382334, 382285..382298, 382200..382283, 382106..382198, 382034..382104,
        382000..382032, 381936..381998, 381816..381934, 381751..381814, 381742..381749,
        381560..381740, 381538..381558, 381425..381536, 381380..381423, 381227..381378,
        381201..381225, 381186..381199, 381135..381184, 381027..381133, 381025,
        381001..381023, 380990..380998, 380972..380988, 380903..380970, 380900..380901,
        380805..380898, 380788..380803, 380728..380786, 380715..380726, 380547..380713,
        380538..380545, 380512..380536, 380508..380510, 380500..380504, 380394..380498,
        380209..380392, 380175..380207, 380173, 380167..380171, 380127..380165,
        380100..380125, 380096..380098, 380060..380088, 380055..380058, 380047..380053,
        380040..380045, 380021..380038, 380000..380019
        'discover'
      when 457633..499999, 457394..457630, 457200..457392, 451417..457099, 438936..451415,
        431275..438934, 401180..431273, 400000..401177
        'visa'
      when 990015, 927001, 689099..690149, 684055..685270, 683020..683945, 681870..682710,
        676455..681790, 672801..676452, 672701..672799, 670960..672699, 670944,
        669672..670911, 669494..669582, 668830..669235, 668700..668761, 668668,
        668412..668503, 668399, 667636..668345, 667361..667531, 667295..667305,
        667230, 667207, 666887..667100, 666680..666739, 666665, 666655, 666414..666554,
        666282..666400, 665942..666099, 665097..665762, 665001..665012, 664463..664765,
        664260..664386, 664055..664097, 663913..663921, 663834, 663574..663726,
        663205..663329, 642491, 642449..642450, 642445, 642433, 642430, 642424,
        642413, 642403..642407, 642393..642401, 642339..642391, 642331..642337,
        642329, 642324..642327, 642319..642321, 642315..642316, 642305..642311,
        642296..642301, 642289..642290, 642286..642287, 642284, 642279..642282,
        642277, 642274..642275, 642258..642270, 642228..642253, 642219..642224,
        642217, 642209..642215, 642204..642207, 642201..642202, 642196..642199,
        642191..642193, 642188, 642185, 642182..642183, 642180, 642173..642176,
        642167..642171, 642164..642165, 642160, 642158, 642154..642155, 642141..642151,
        642134..642139, 642131, 642117..642128, 642113..642114, 642110, 642106..642108,
        642101, 642094..642099, 642081..642092, 642076..642077, 642073..642074,
        642068..642071, 642065, 642062..642063, 642060, 642052..642054, 642048..642049,
        642041..642045, 642037..642039, 642020..642032, 642016, 642011..642012,
        642003..642007, 642000, 641988..641993, 641976..641978, 641974, 641972,
        641965, 641960..641962, 641952..641957, 641947..641948, 641922..641939,
        641918..641919, 641909..641913, 641898..641905, 641890, 641888, 641885,
        641875..641882, 641862..641873, 641859..641860, 641855..641857, 641848..641852,
        641842..641846, 641832..641840, 641830, 641815..641826, 641808, 641803,
        641789..641801, 641786..641787, 641781..641783, 641776..641778, 641763..641773,
        641761, 641756..641758, 641749..641753, 641744..641747, 641730..641739,
        641728, 641723..641724, 641705..641719, 641701..641702, 641695..641699,
        641691, 641680..641686, 641676..641677, 641663..641668, 641661, 641654..641655,
        641646..641647, 641635..641641, 641631, 641628..641629, 641618..641624,
        641615..641616, 641613, 641606..641609, 641597..641601, 641593..641594,
        641584, 641582, 641578..641580, 641572..641573, 641566, 641563, 641554..641555,
        641551, 641539..641548, 641523..641537, 641519, 641512..641514, 641498..641507,
        641486..641493, 641471, 641466..641467, 641464, 641462, 641448..641458,
        641439..641445, 641436..641437, 641423..641434, 641416..641418, 641412,
        641409, 641401, 641395..641399, 641385..641388, 641377..641382, 641370..641372,
        641366..641368, 641362..641364, 641358, 641340..641347, 641333..641336,
        641330, 641318..641325, 641309..641313, 641305, 641300..641303, 641298,
        641291..641295, 641286..641289, 641283, 641274..641276, 641272, 641267..641270,
        641261..641264, 641253..641259, 641251, 641241..641245, 641233..641238,
        641224..641227, 641213..641218, 641204..641207, 641194..641199, 641189,
        641185, 641176..641180, 641174, 641171, 641169, 641158..641165, 641151..641152,
        641147, 641143, 641134..641141, 641109..641131, 641104..641106, 641088..641102,
        641086, 641075..641083, 641063..641071, 641059..641060, 641056, 641047..641053,
        641039..641042, 641035, 641032, 641030, 641021..641026, 641017, 641009..641014,
        640994..641006, 640987..640991, 640981..640984, 640974, 640971, 640959..640964,
        640955, 640944..640951, 640940..640942, 640934..640935, 640928, 640918..640922,
        640912, 640908, 640900..640901, 640896..640898, 640889..640890, 640870..640883,
        640861, 640856, 640850..640852, 640847..640848, 640844..640845, 640839,
        640835..640836, 640831, 640823..640828, 640815, 640802..640813, 640795..640800,
        640790..640792, 640786, 640776, 640765..640772, 640755..640763, 640752,
        640743..640748, 640741, 640738, 640733..640735, 640724..640730, 640716..640719,
        640714, 640702..640708, 640697..640699, 640693..640694, 640685..640691,
        640678, 640671..640675, 640663..640668, 640658..640659, 640650..640656,
        640647..640648, 640638..640642, 640629..640632, 640619..640621, 640611..640614,
        640608..640609, 640600..640601, 640593, 640589, 640586, 640579..640582,
        640568..640575, 640558..640565, 640553..640555, 640542..640548, 640519..640536,
        640511..640512, 640504..640509, 640500..640501, 640490..640491, 640481..640483,
        640479, 640475..640476, 640469..640472, 640464, 640460, 640455..640457,
        640438..640451, 640430..640436, 640427..640428, 640423..640424, 640416..640417,
        640408..640412, 640404, 640399, 640389..640393, 640380..640382, 640375..640377,
        640367..640371, 640356..640361, 640342..640352, 640334..640336, 640330..640331,
        640303..640322, 640299..640300, 640288..640289, 640282..640285, 640268..640272,
        640265, 640256, 640251..640254, 640246..640249, 640241..640243, 640237,
        640233, 640227..640231, 640221, 640216..640217, 640211, 640201, 640195,
        640192, 640190, 640185..640188, 640182, 640178..640180, 640172, 640167..640168,
        640161..640163, 640158, 640150..640152, 640147, 640143, 640141, 640128..640136,
        640118..640124, 640103..640113, 640094..640095, 640092, 640087, 640085,
        640081, 640060..640075, 640047..640057, 640045, 640040, 640037, 640031..640035,
        640024..640028, 640018..640021, 640011..640013, 640005..640006, 639781..640001,
        639381..639777, 639000..639358, 637102..637529, 636868, 636392..636708,
        636325..636366, 636181..636261, 633845..636173, 633698..633817, 633641..633675,
        633174..633513, 633110, 629441..630499, 628133..628182, 628078..628127,
        627937..628065, 627786..627920, 627781..627784, 627764..627779, 627747..627762,
        627737..627745, 627726..627735, 627687..627724, 627635..627674, 627539..627609,
        627391..627534, 627385, 627188..627380, 627101..627173, 627089, 626257,
        623000, 622989..622998, 622986, 622982..622983, 622977..622980, 622975,
        622971..622973, 622967..622968, 622959..622963, 622957, 622955, 622949..622953,
        622945..622947, 622942..622943, 622935..622940, 622932..622933, 622433,
        622123..622125, 622114..622121, 622106..622112, 622079..622099, 622055..622077,
        622044, 622007..622020, 622004..622005, 621984..622002, 621978, 621830..621976,
        621427, 621409, 621356, 621346..621347, 621338, 621326, 621289, 621260,
        621250, 621241, 621092, 621059, 621055..621056, 621019, 620272, 614552..620009,
        610093..610559, 607770, 607733, 607727, 607656, 607637, 607611, 607600,
        607475, 607347, 607327, 607300, 607215, 607209, 607026, 606801, 606484,
        606469, 606457, 606452, 606450, 606444..606445, 606441, 606436, 606410,
        606404, 606401, 606394..606395, 606389, 606384..606386, 606379, 606374,
        606372, 606364..606365, 606361, 606349, 606339, 606335..606337, 606329,
        606325, 606321, 606305, 606299, 606295, 606287, 606284..606285, 606280,
        606274, 606269, 606263, 606260, 606257, 606252, 606238, 606236, 606233,
        606228, 606224, 606209, 606200, 606179, 606172, 606166, 606163, 606144..606145,
        606139, 606124..606126, 606114, 606101, 606090..606099, 606072..606088,
        605072..606070, 605070, 604914..605068, 604776..604912, 604400..604740,
        604375, 604341, 604332, 604327, 604319, 604316..604317, 604249..604299,
        603839..604247, 603800..603837, 603743..603797, 603709..603741, 603696..603707,
        603683..603693, 603634..603681, 603608..603632, 603602..603605, 603533..603600,
        603494..603531, 603492, 603445..603480, 603390..603420, 603378..603383,
        603298..603353, 603250..603289, 603215..603246, 603211..603213, 603147..603209,
        603110..603139, 603024..603098, 603006..603008, 602999..603003, 602991,
        602989, 602985, 602973..602983, 602970..602971, 602968, 602961..602962,
        602949..602957, 602942..602945, 602940, 602933..602936, 602919..602927,
        602917, 602904..602910, 602898, 602892..602893, 602885..602889, 602864..602879,
        602857, 602700..602849, 602691..602695, 602675..602678, 602673, 602648..602667,
        602084..602086, 602005..602082, 601900..602000, 601875..601887, 601859,
        601840..601842, 601823, 601728..601796, 601724, 601689..601709, 601659..601687,
        601616..601657, 601594..601614, 601579..601589, 601532..601534, 601518..601521,
        601493..601500, 601473..601474, 601466, 601377..601453, 601309..601368,
        601301, 601286..601299, 601281..601284, 601279, 601228..601276, 601214..601226,
        601206..601212, 601201..601203, 601079..601094, 601065..601075, 601039..601059,
        601021..601036, 600961..601004, 600877..600957, 600384..600875, 600364..600382,
        600206..600362, 589997..599900, 589995, 589986..589993, 589982..589984,
        589969..589979, 589966..589967, 589923..589964, 589905..589921, 589883..589902,
        589875..589881, 589872..589873, 589869..589870, 589851..589867, 589842..589849,
        589837..589840, 589802..589835, 589797..589800, 589783..589793, 589775..589779,
        589769..589773, 589747..589765, 589738..589745, 589717..589734, 589700..589714,
        589671..589696, 589632..589665, 589600..589629, 589597, 589587..589594,
        589582..589583, 589569..589571, 589561..589563, 589558..589559, 589546..589553,
        589542, 589536, 589530..589532, 589513..589527, 589504..589506, 589500,
        589490..589492, 589488, 589471..589477, 589444..589465, 589434..589437,
        589428..589430, 589412..589425, 589407..589409, 589399, 589379..589394,
        589375, 589358..589373, 589350..589356, 589339..589346, 589304..589334,
        589278..589298, 589274, 589261..589271, 589241..589256, 589226..589232,
        589204..589222, 589197..589200, 589188..589192, 589181, 589175..589176,
        589164..589170, 589153..589161, 589115..589140, 589103..589112, 589099..589101,
        589079..589088, 589077, 589073, 589068, 589059, 589017..589051, 589014,
        589000..589006, 588995..588998, 588991..588993, 588982..588984, 588975..588979,
        588931..588969, 588916, 588910..588913, 588894..588903, 588877..588891,
        588843..588871, 588836..588837, 588829..588832, 588812..588826, 588801..588804,
        588761..588792, 588715..588756, 588706, 588698..588701, 588686..588696,
        588673..588680, 588667, 588656..588665, 588644..588652, 588632..588640,
        588624, 588620, 588610..588613, 588608, 588597..588602, 588588..588592,
        588570..588582, 588566, 588556..588560, 588545..588546, 588540..588541,
        588535, 588531, 588512..588527, 588510, 588505..588507, 588501..588502,
        588498, 588494..588496, 588491, 588484, 588479..588480, 588473..588475,
        588471, 588461, 588457..588459, 588423..588455, 588414..588420, 588407..588408,
        588400..588402, 588389..588392, 588381..588384, 588377..588378, 588375,
        588363..588371, 588353..588360, 588351, 588345, 588339..588341, 588330..588331,
        588315..588328, 588308..588310, 588299..588305, 588292..588297, 588286..588290,
        588283, 588274..588278, 588266..588270, 588259..588261, 588253..588255,
        588246, 588233..588239, 588230, 588225..588227, 588216..588221, 588204..588205,
        588196, 588194, 588192, 588174..588180, 588164..588167, 588154..588162,
        588151, 588140..588143, 588133..588134, 588130, 588118..588127, 588114,
        588111, 588105..588106, 588101, 588099, 588094..588096, 588086..588087,
        588081..588082, 588077, 588064..588068, 588062, 588058..588060, 588053..588055,
        588045..588046, 588035, 588025..588031, 588021..588023, 588015..588016,
        587999..588011, 587995, 587993, 587989..587991, 587985, 587954..587982,
        587951..587952, 587947, 587943, 587932, 587930, 587925..587927, 587919,
        587913..587915, 587900..587908, 587891..587896, 587885..587887, 587866..587883,
        587854..587856, 587851..587852, 587845..587849, 587837..587843, 587827..587828,
        587820..587822, 587815, 587809, 587798..587799, 587785..587791, 587777..587783,
        587775, 587772, 587767..587770, 587758..587761, 587756, 587752, 587750,
        587745, 587734..587740, 587728..587730, 587722, 587717, 587707..587713,
        587704, 587699..587701, 587696, 587693, 587691, 587686, 587683, 587678..587679,
        587676, 587665..587671, 587661, 587657, 587649..587654, 587643..587645,
        587634..587641, 587631, 587612..587628, 587601..587610, 587596..587599,
        587590..587592, 587576..587588, 587568..587571, 587560..587563, 587554,
        587549..587551, 587545, 587536..587538, 587533..587534, 587526..587530,
        587520, 587514..587518, 587508, 587497..587503, 587494..587495, 587487..587491,
        587483..587484, 587478..587479, 587456..587474, 587452..587454, 587447..587450,
        587438, 587425, 587416, 587413, 587396..587409, 587391..587392, 587387,
        587384, 587375..587380, 587371, 587362, 587359, 587343..587354, 587331..587341,
        587326, 587322..587323, 587315..587317, 587308..587309, 587300..587305,
        587297..587298, 587292, 587279..587288, 587274..587277, 587244..587269,
        587237..587241, 587235, 587229, 587223, 587215..587219, 587205..587209,
        587202, 587195, 587191, 587186..587188, 587153..587176, 587141..587148,
        587136, 587128..587130, 587110..587122, 587093, 587084..587086, 587072..587080,
        587069, 587060..587065, 587054..587057, 587051, 587041, 587033..587037,
        587027, 587018..587020, 587008, 587001..587006, 586989..586995, 586980..586987,
        586975, 586961..586966, 586957..586958, 586941..586944, 586927..586933,
        586914..586924, 586906..586912, 586896, 586894, 586882..586888, 586860..586874,
        586836..586852, 586824..586834, 586811..586814, 586798..586806, 586748..586796,
        586743..586745, 586739, 586735, 586730..586732, 586725..586728, 586720..586723,
        586707..586717, 586685..586701, 586682, 586676, 586666..586673, 586659..586661,
        586649..586652, 586641..586642, 586629, 586622, 586605..586619, 586598..586599,
        586596, 586593, 586576..586586, 586570, 586552..586563, 586545..586548,
        586540, 586537, 586518..586533, 586509, 586504, 586501, 586492..586494,
        586489, 586470..586486, 586468, 586462..586463, 586454..586459, 586445..586449,
        586432..586435, 586422..586423, 586407, 586393..586403, 586382..586387,
        586369..586372, 586357..586364, 586347..586353, 586340..586344, 586329..586337,
        586326, 586314..586317, 586303, 586298, 586292, 586281..586290, 586275,
        586255..586270, 586222..586252, 586205, 586197..586198, 586189..586194,
        586184..586186, 586166..586175, 586158..586163, 586146..586154, 586138..586143,
        586110..586135, 586107, 586097..586105, 586093, 586091, 586085, 586079,
        586076, 586072..586074, 586062..586064, 586057, 586032..586055, 586024..586026,
        586020, 586017..586018, 586010..586011, 585901..586005, 585887..585892,
        585880..585882, 585875, 585846..585871, 585813..585837, 585800, 585792..585795,
        585789, 585739..585772, 585726..585734, 585719..585720, 585705..585716,
        585693..585702, 585680..585690, 585663..585677, 585651, 585635..585642,
        585617..585626, 585609..585611, 585396..585596, 585393, 585369..585388,
        585358..585360, 585345..585354, 585335..585340, 585307..585320, 585302..585303,
        585294..585298, 585286..585292, 585281, 585265..585279, 585256, 585249..585253,
        585237..585243, 585223..585224, 585192..585219, 585167..585186, 585164,
        585154..585160, 585149..585151, 585131..585144, 585126, 585095..585122,
        585072..585091, 585066..585068, 585060, 585054, 585045..585050, 585030..585039,
        585025..585028, 585011..585021, 584993..584998, 584988, 584986, 584968,
        584963, 584960..584961, 584957..584958, 584940..584942, 584932, 584925..584927,
        584922, 584918, 584915, 584909..584911, 584902..584906, 584896, 584892,
        584890, 584886, 584884, 584867..584879, 584863, 584859..584861, 584854,
        584842..584848, 584836..584839, 584830..584833, 584827, 584817..584821,
        584813, 584810, 584797..584807, 584794, 584783, 584779..584780, 584757..584775,
        584754, 584750..584751, 584747, 584727..584743, 584724..584725, 584721..584722,
        584714..584719, 584712, 584710, 584704..584708, 584700, 584689..584695,
        584687, 584684, 584674..584682, 584671..584672, 584660..584666, 584657,
        584654, 584648..584650, 584646, 584630..584641, 584622..584628, 584609..584618,
        584599..584606, 584595, 584587..584593, 584570..584584, 584568, 584561,
        584557, 584551..584553, 584544..584549, 584534, 584524..584531, 584512..584522,
        584500..584504, 584495, 584493, 584486..584489, 584484, 584474..584477,
        584468..584469, 584456..584464, 584452..584453, 584439..584446, 584432..584433,
        584428..584429, 584421..584424, 584414, 584406, 584403, 584393..584400,
        584388, 584385, 584379..584382, 584367..584374, 584362, 584355..584359,
        584348..584352, 584344..584346, 584336..584340, 584328..584330, 584325,
        584320..584323, 584309..584313, 584293..584298, 584288, 584285, 584276..584282,
        584267..584272, 584252..584262, 584246..584249, 584239..584242, 584224..584232,
        584221..584222, 584194..584218, 584190, 584188, 584178..584184, 584164..584169,
        584160, 584157, 584151, 584139..584147, 584136, 584132..584133, 584130,
        584128, 584106..584120, 584101, 584095, 584090..584091, 584087, 584083,
        584081, 584074..584078, 584064, 584059, 584056, 584053..584054, 584050,
        584039..584042, 584029, 584021..584024, 584013..584016, 584009..584010,
        584000..584007, 583994..583998, 583991..583992, 583989, 583984, 583978..583981,
        583972..583973, 583968, 583965, 583962, 583958, 583951..583953, 583945..583949,
        583941, 583936..583937, 583922..583933, 583920, 583910..583918, 583904..583907,
        583900, 583889..583892, 583881..583883, 583877, 583874..583875, 583866..583870,
        583862..583864, 583855..583859, 583846, 583836, 583824..583825, 583820,
        583814..583817, 583794..583807, 583791, 583787, 583783, 583774, 583759..583761,
        583747..583756, 583743, 583737..583741, 583725..583730, 583717, 583709..583715,
        583706, 583696..583704, 583686..583693, 583681..583683, 583677, 583675,
        583672, 583664..583665, 583660, 583656, 583645..583649, 583640..583643,
        583636, 583634, 583630..583632, 583626, 583617..583622, 583614, 583611,
        583602, 583598..583599, 583591..583592, 583586..583588, 583577..583584,
        583574, 583561..583567, 583559, 583546..583556, 583543, 583535..583539,
        583527..583530, 583524..583525, 583519..583520, 583515, 583497..583512,
        583494..583495, 583492, 583485..583489, 583475..583483, 583460..583470,
        583444..583455, 583441, 583438..583439, 583434, 583424..583428, 583413..583415,
        583408, 583406, 583403, 583389..583397, 583378..583382, 583369..583372,
        583362..583364, 583358..583359, 583355, 583349..583353, 583345..583346,
        583340..583342, 583333, 583329, 583325..583326, 583322..583323, 583312..583319,
        583310, 583298..583302, 583294, 583292, 583290, 583284..583287, 583282,
        583277..583279, 583274..583275, 583265..583271, 583255..583260, 583250..583251,
        583241..583247, 583236, 583228..583229, 583221..583226, 583207..583214,
        583195..583200, 583189..583192, 583183..583187, 583178, 583176, 583155..583173,
        583151, 583147, 583135..583141, 583128..583132, 583114..583126, 583109,
        583096..583104, 583092, 583085..583090, 583082..583083, 583073..583077,
        583064, 583053..583058, 583041, 583036, 583023..583027, 583011, 582999..583006,
        582993, 582986..582988, 582976..582980, 582971, 582965, 582963, 582957..582960,
        582951..582954, 582948, 582919..582941, 582902..582916, 582898, 582895,
        582888..582889, 582880..582882, 582875, 582868, 582864..582865, 582862,
        582851..582859, 582849, 582838..582839, 582836, 582832, 582826..582830,
        582821, 582814..582818, 582807, 582793..582803, 582790, 582782..582784,
        582777, 582771..582773, 582768, 582759..582766, 582750..582753, 582745..582748,
        582742..582743, 582730, 582716..582723, 582711..582713, 582706..582709,
        582693..582701, 582674..582690, 582670..582672, 582668, 582664..582666,
        582662, 582657, 582650..582652, 582644..582646, 582638, 582634..582636,
        582631, 582629, 582624, 582617..582618, 582605, 582601..582602, 582598..582599,
        582594, 582588..582591, 582580..582581, 582572..582575, 582568..582570,
        582565, 582560..582561, 582555, 582548..582551, 582542..582545, 582536,
        582530..582531, 582527..582528, 582522..582524, 582520, 582518, 582511..582514,
        582508, 582505..582506, 582500..582502, 582490..582494, 582483..582488,
        582476..582479, 582472..582473, 582466, 582463, 582459, 582452..582453,
        582450, 582442..582444, 582433, 582422..582431, 582416, 582413, 582411,
        582407, 582400, 582398, 582392, 582384..582390, 582368..582380, 582354..582363,
        582347..582349, 582344, 582339..582342, 582332, 582327, 582309..582321,
        582304, 582295..582300, 582285, 582281..582282, 582275..582278, 582272,
        582267, 582259..582265, 582255, 582252..582253, 582237..582250, 582232..582234,
        582220..582228, 582218, 582208..582211, 582192..582204, 582189..582190,
        582187, 582178..582182, 582150..582172, 582144..582148, 582141, 582131..582136,
        582122..582128, 582117, 582113..582114, 582100..582110, 582096, 582086..582093,
        582077..582083, 582069..582072, 582065, 582052..582060, 582048..582049,
        582045..582046, 582041..582043, 582037..582039, 582034, 582016..582028,
        582012..582013, 582004..582007, 581998..582001, 581996, 581991..581993,
        581987, 581980, 581969..581978, 581959..581961, 581950..581954, 581946..581947,
        581943, 581936, 581926..581934, 581920, 581918, 581908..581915, 581902..581905,
        581840..581890, 581816..581828, 581802..581806, 581700..581800, 581698,
        581693..581695, 581681..581686, 581667..581675, 581662, 581657..581659,
        581650..581653, 581640..581645, 581627..581635, 581621, 581618, 581607..581616,
        581604, 581599..581600, 581594..581597, 581585..581591, 581582..581583,
        581578, 581573..581574, 581564..581568, 581556..581559, 581552, 581546..581550,
        581527..581533, 581513..581523, 581497..581508, 581493, 581491, 581486..581489,
        581480, 581470..581476, 581467, 581463, 581453..581461, 581446..581450,
        581436, 581416..581425, 581410..581412, 581404..581406, 581399, 581396,
        581379..581391, 581365..581377, 581356..581363, 581345..581352, 581343,
        581340..581341, 581330..581336, 581319..581323, 581317, 581312..581314,
        581296..581309, 581293..581294, 581283..581287, 581280, 581258..581277,
        581255..581256, 581251..581253, 581238..581248, 581229..581235, 581224..581226,
        581218..581219, 581214, 581204..581209, 581199, 581157..581195, 581149..581153,
        581136..581139, 581125..581131, 581123, 581120, 581090..581117, 581072..581080,
        580911..581070, 580902..580904, 580890, 580814..580841, 580642..580803,
        580493..580628, 580440..580456, 580430, 580409..580420, 580400..580402,
        580379..580382, 580370, 580344..580357, 580321..580334, 580313, 580287..580302,
        580256..580279, 580231..580244, 580210..580213, 580188..580190, 580185,
        580155..580160, 580151, 580148..580149, 580139..580140, 580133..580136,
        580120..580123, 580096..580116, 580092, 580087..580088, 580073..580076,
        580070..580071, 580057..580063, 580049..580054, 580046, 580039..580040,
        580028..580034, 580022..580023, 580012..580019, 580008, 580004, 579990..580002,
        579974..579988, 579942..579972, 579932..579938, 579923..579928, 579903,
        579890..579895, 579723..579886, 579720, 579707, 579688..579689, 579685,
        579674, 579668, 579664, 579650, 579645..579646, 579641, 579638, 579620,
        579618, 579601..579602, 579592..579598, 579588, 579581..579585, 579578..579579,
        579575..579576, 579570..579572, 579567..579568, 579564..579565, 579560..579562,
        579545..579547, 579540..579543, 579535..579538, 579532..579533, 579530,
        579522..579526, 579517..579518, 579511..579512, 579508, 579503..579504,
        579499..579501, 579497, 579494, 579492, 579487..579489, 579484, 579479..579480,
        579473, 579471, 579468, 579463, 579461, 579459, 579448..579455, 579436..579446,
        579427..579428, 579424, 579422, 579413..579415, 579408, 579402..579406,
        579398..579399, 579390..579395, 579386, 579382, 579378..579380, 579374..579375,
        579369..579372, 579367, 579359..579361, 579352..579357, 579340..579349,
        579338, 579334..579335, 579330..579332, 579323..579328, 579319..579321,
        579311..579317, 579307..579308, 579299..579302, 579293..579294, 579286..579289,
        579279..579284, 579275..579276, 579272..579273, 579267..579269, 579259..579265,
        579257, 579252..579254, 579243..579248, 579238..579241, 579218..579234,
        579213..579214, 579210, 579207..579208, 579205, 579201, 579197..579198,
        579195, 579192, 579189, 579187, 579179..579184, 579176..579177, 579169..579173,
        579167, 579159..579164, 579150..579156, 579143..579147, 579141, 579129..579138,
        579123..579127, 579120..579121, 579116..579118, 579113, 579109, 579106,
        579100..579103, 579098, 579095..579096, 579088..579089, 579069..579086,
        579063..579064, 579060, 579058, 579050..579055, 579045, 579039..579041,
        579035..579036, 579029..579030, 579024..579027, 579021, 579019, 579014,
        579011, 578346..579009, 578289..578294, 578287, 578285, 578279..578281,
        578275, 578268..578273, 578266, 578260..578264, 578251..578258, 578248..578249,
        578242..578245, 578227..578236, 578224..578225, 578220..578222, 578212..578214,
        578209, 578203..578206, 578201, 578197..578199, 578190..578191, 578188,
        578186, 578178..578184, 578173..578175, 578163..578171, 578158..578160,
        578155, 578143..578152, 578134..578140, 578129..578130, 578122, 578120,
        578115..578116, 578110..578112, 578105..578107, 578102..578103, 578095..578100,
        578091, 578087..578088, 578083..578084, 578080..578081, 578077..578078,
        578073..578074, 578056..578068, 578046..578054, 578043..578044, 578034..578038,
        578027..578030, 578020, 578015..578017, 578011..578012, 577999..578007,
        577990..577994, 577976..577988, 577969..577970, 577967, 577965, 577963,
        577957, 577953..577954, 577948..577950, 577939..577942, 577934..577936,
        577930..577931, 577924..577928, 577922, 577919..577920, 577915, 577910..577912,
        577907, 577903..577904, 577898..577900, 577888..577890, 577884..577885,
        577881, 577876..577879, 577874, 577864..577865, 577859..577860, 577848..577856,
        577845, 577840..577842, 577837, 577834, 577830..577831, 577827..577828,
        577822..577824, 577814..577819, 577811, 577805..577807, 577803, 577783..577795,
        577780, 577775, 577772..577773, 577767..577770, 577765, 577761..577763,
        577754..577757, 577752, 577749..577750, 577742..577747, 577735..577737,
        577732..577733, 577728..577729, 577708..577723, 577706, 577703..577704,
        577700, 577694..577695, 577688, 577682..577686, 577680, 577674..577676,
        577668..577672, 577663..577665, 577655..577660, 577651..577653, 577649,
        577643..577646, 577637..577641, 577630..577632, 577628, 577624, 577618..577622,
        577615..577616, 577607..577610, 577594..577601, 577583..577590, 577581,
        577578, 577574..577575, 577571, 577568, 577557..577560, 577554..577555,
        577549, 577547, 577543, 577540, 577536..577537, 577531..577532, 577528..577529,
        577519..577524, 577515..577517, 577512..577513, 577510, 577506..577508,
        577503, 577495..577497, 577491..577492, 577488..577489, 577482..577484,
        577477..577478, 577474..577475, 577464..577469, 577456..577459, 577444..577450,
        577442, 577438, 577435..577436, 577430..577433, 577423..577424, 577414..577419,
        577412, 577408, 577405, 577399..577402, 577394, 577389..577392, 577380..577387,
        577374..577378, 577371..577372, 577366..577369, 577359..577360, 577357,
        577349..577350, 577346, 577342, 577337, 577333..577334, 577329..577331,
        577327, 577321, 577318..577319, 577316, 577313, 577309..577310, 577306,
        577301..577302, 577289..577294, 577283..577287, 577280..577281, 577277,
        577271..577275, 577265..577267, 577262, 577244..577258, 577225..577240,
        577221, 577218..577219, 577213..577214, 577210, 577204..577206, 577199..577200,
        577195..577197, 577188..577193, 577179, 577174..577176, 577171..577172,
        577166..577168, 577162, 577153..577156, 577142..577150, 577134..577139,
        577131, 577129, 577126, 577121..577123, 577119, 577117, 577112..577115,
        577108, 577103..577106, 577098..577101, 577091..577095, 577089, 577087,
        577082..577083, 577079, 577072..577074, 577062..577069, 577056, 577042..577050,
        577015..577040, 577012..577013, 577003, 576337..576987, 575920..576321,
        575823..575912, 575819..575820, 575813..575817, 575809..575811, 575807,
        575796..575803, 575793, 575789, 575783, 575774..575779, 575770..575771,
        575757..575766, 575751..575754, 575746..575748, 575742..575744, 575735..575738,
        575730..575732, 575716..575725, 575711..575712, 575706..575708, 575700..575704,
        575687..575695, 575670..575683, 575659..575663, 575657, 575655, 575647..575648,
        575645, 575632..575641, 575627, 575619..575622, 575614, 575611, 575606..575609,
        575538..575599, 575520..575522, 575513, 575494..575502, 575486..575492,
        575477..575484, 575453..575462, 575438..575450, 575435, 575427..575432,
        575414..575417, 575376..575381, 575373, 575367..575369, 575353..575362,
        575327..575334, 575318, 575308, 575305, 575300..575302, 575285..575287,
        575276..575280, 575241..575245, 575196..575209, 575148..575192, 575112..575141,
        575080..575105, 575049..575055, 575039, 575035, 575000..575003, 574993,
        574954..574966, 574933..574936, 574898..574923, 574885..574895, 574876..574879,
        574847..574859, 574825..574843, 574804..574809, 574800, 574774..574794,
        574714..574747, 574650..574672, 574534..574639, 574518..574530, 574446..574503,
        574389..574444, 574290..574367, 574234..574273, 574206..574226, 574185..574190,
        574169..574172, 574165..574166, 574143..574153, 574131..574135, 574128..574129,
        574120, 574108..574111, 574067..574100, 574050, 574008..574042, 573961..574001,
        573957, 573920..573951, 573910..573915, 573880..573905, 573872..573877,
        573850..573864, 573843, 573815..573839, 573805, 573798..573802, 573789..573792,
        573650..573785, 573587..573628, 573549..573581, 573536..573541, 573532,
        573495..573528, 573490, 573458..573463, 573448, 573403..573446, 573361..573395,
        573339..573340, 573335, 573330, 573308, 573278..573295, 573270..573271,
        573249..573254, 573228..573245, 573217..573221, 573206, 573192, 573178..573186,
        573170, 573149..573163, 573111..573120, 573099..573103, 573059..573089,
        573037..573046, 573024, 573000..573003, 572963..572988, 572937..572952,
        572889..572927, 572877, 572869, 572853, 572828..572848, 572815..572820,
        572807, 572802, 572758..572796, 572704..572747, 572683, 572675, 572657..572668,
        572642, 572625..572626, 572618..572622, 572610..572611, 572602..572607,
        572595..572600, 572565..572592, 572557..572562, 572550, 572539..572545,
        572529..572533, 572519..572520, 572496..572515, 572468..572489, 572449..572455,
        572431..572432, 572409..572420, 572402..572406, 572389, 572346..572379,
        572325..572332, 572319, 572277..572310, 572237..572261, 572226..572227,
        572188..572201, 572167, 572156..572164, 572149..572154, 572121..572136,
        572107..572112, 572088..572090, 572073..572074, 572048..572052, 572034..572039,
        572027, 572022, 572018, 572011..572013, 571996..572000, 571982, 571968..571973,
        571952..571959, 571943..571945, 571930..571931, 571913..571921, 571904..571907,
        571890, 571874..571884, 571852..571871, 571824..571837, 571818, 571805..571813,
        571796..571800, 571790, 571760, 571709..571754, 571686..571702, 571646..571669,
        571615..571641, 571591..571605, 571581, 571563..571570, 571526..571545,
        571512..571517, 571505, 571501, 571476..571496, 571432..571459, 571382..571423,
        571368, 571331..571357, 571320..571327, 571292..571317, 571276..571282,
        571261..571272, 571254, 571245..571247, 571229..571239, 571225, 571201..571222,
        571187, 571180, 571175..571176, 571162..571167, 571134..571150, 571113..571119,
        571098..571100, 571076..571081, 571073, 571057..571063, 571051, 571040,
        571035..571037, 571020..571022, 571010, 570992..571004, 570982..570985,
        570977, 570970, 570947..570952, 570935, 570907..570917, 570888..570902,
        570874, 570852..570865, 570839..570840, 570831, 570816..570817, 570795..570800,
        570788..570791, 570767..570774, 570740..570760, 570700..570728, 570673,
        570649..570670, 570634, 570586..570606, 570566, 570525..570556, 570477..570519,
        570433..570460, 570401..570423, 570394, 570382..570388, 570366..570376,
        570357, 570287..570336, 570281..570284, 570243..570255, 570225..570236,
        570220, 570212..570213, 570118..570190, 570062..570112, 568699..570042,
        568643..568689, 568632..568641, 568626, 568616..568621, 568613, 568597..568609,
        568595, 568592, 568587..568588, 568581..568585, 568577, 568575, 568566..568569,
        568563..568564, 568561, 568559, 568555..568557, 568549..568551, 568544..568546,
        568535..568538, 568532, 568529..568530, 568524..568526, 568516..568517,
        568512, 568508..568509, 568506, 568496..568501, 568494, 568491, 568487..568488,
        568478..568479, 568469..568475, 568467, 568459..568462, 568454..568457,
        568451..568452, 568438, 568433..568434, 568431, 568415..568429, 568410,
        568404..568408, 568392..568394, 568387, 568384..568385, 568378..568379,
        568375..568376, 568371..568372, 568369, 568366, 568364, 568357..568358,
        568350..568355, 568348, 568341..568342, 568335..568337, 568326..568327,
        568312, 568309, 568304, 568302, 568294..568298, 568290..568291, 568286,
        568280..568283, 568276..568277, 568268..568269, 568260..568266, 568258,
        568252..568255, 568245..568247, 568237..568239, 568232, 568227..568229,
        568217..568225, 568206..568208, 568196, 568190, 568184..568185, 568177,
        568169..568173, 568163..568165, 568155..568159, 568136..568149, 568132..568134,
        568121..568130, 568115, 568108..568113, 568106, 568103, 568099, 568094..568096,
        568092, 568088..568089, 568086, 568080, 568073..568075, 568057..568064,
        568047..568053, 568044, 568040, 568032..568036, 568024..568030, 568021,
        568009..568018, 567999..568004, 567993..567994, 567991, 567987, 567981..567983,
        567976..567978, 567969..567970, 567959..567962, 567955..567957, 567952,
        567946..567950, 567944, 567926..567935, 567916..567920, 567913..567914,
        567909, 567906, 567902, 567898..567899, 567895, 567891, 567887..567889,
        567878..567880, 567866..567872, 567863, 567860, 567856, 567850..567852,
        567846..567848, 567831..567843, 567829, 567824..567826, 567821..567822,
        567816..567818, 567809..567813, 567800..567803, 567793..567796, 567790,
        567788, 567785, 567771..567778, 567765..567766, 567761..567763, 567753..567758,
        567749, 567745, 567740..567741, 567730..567737, 567715..567723, 567709..567711,
        567705, 567699..567702, 567690, 567688, 567682, 567677, 567672..567675,
        567668, 567666, 567662, 567648..567656, 567642, 567624..567634, 567621,
        567612..567616, 567608, 567604, 567601, 567599, 567594..567597, 567591,
        567585..567588, 567582, 567576..567577, 567572, 567567..567569, 567556..567564,
        567546..567548, 567543..567544, 567541, 567536..567537, 567532..567533,
        567524..567525, 567519, 567505..567511, 567495..567500, 567492, 567487..567490,
        567483..567485, 567479, 567458..567470, 567449..567453, 567441, 567434..567439,
        567425..567432, 567418, 567407..567412, 567403, 567393..567397, 567377..567389,
        567374..567375, 567363, 567359..567360, 567355..567357, 567344..567349,
        567339..567340, 567332, 567330, 567326..567327, 567321..567323, 567312..567318,
        567304..567309, 567302, 567298, 567289..567294, 567285, 567282, 567279,
        567271..567273, 567267, 567264..567265, 567258..567262, 567251..567252,
        567246, 567240..567244, 567237, 567230, 567220..567228, 567213..567215,
        567206..567210, 567201..567204, 567190..567191, 567182..567185, 567177..567179,
        567163..567172, 567159, 567155, 567143..567152, 567133..567136, 567121..567125,
        567118, 567103..567116, 567095..567097, 567092..567093, 567088..567090,
        567080..567085, 567075, 567066..567073, 567062, 567060, 567049..567055,
        567047, 567040..567041, 567037, 567023..567032, 567013..567018, 567011,
        567006..567009, 567003, 567000, 566994..566997, 566978..566991, 566973,
        566963..566970, 566958, 566955, 566948..566953, 566943..566946, 566938..566941,
        566926..566931, 566920..566921, 566916..566918, 566914, 566903..566911,
        566897..566900, 566881..566894, 566868..566874, 566856..566862, 566850,
        566844..566846, 566841, 566837..566839, 566829..566834, 566820..566823,
        566816, 566813, 566808..566810, 566801..566805, 566797..566798, 566793..566795,
        566790..566791, 566782..566783, 566778..566779, 566774, 566767..566772,
        566757..566761, 566755, 566752, 566749..566750, 566744..566745, 566738..566739,
        566736, 566733..566734, 566730, 566726, 566714..566722, 566709, 566701..566705,
        566695..566698, 566686..566693, 566682..566683, 566679, 566677, 566675,
        566670, 566666, 566663, 566653..566658, 566649..566650, 566644..566647,
        566638, 566628..566632, 566619..566621, 566606..566609, 566602..566604,
        566593..566599, 566586..566589, 566584, 566573..566575, 566567, 566560..566564,
        566554..566557, 566549..566550, 566544..566546, 566522..566541, 566515..566517,
        566511..566513, 566492..566509, 566487, 566483, 566466..566481, 566453..566458,
        566450..566451, 566448, 566439, 566431, 566426, 566416..566418, 566412..566414,
        566408, 566399, 566379..566397, 566367..566377, 566363, 566353..566360,
        566346..566350, 566338..566342, 566327..566334, 566319..566321, 566308..566314,
        566304, 566297..566300, 566290, 566270..566283, 566260, 566254..566256,
        566242..566250, 566240, 566225..566231, 566220, 566213..566218, 566199..566210,
        566184..566192, 566177..566182, 566161..566175, 566154, 566151, 565616..566140,
        565606, 565245..565600, 565234, 565230, 565224..565227, 565218..565222,
        565210..565211, 565180..565207, 565176, 565165..565169, 565142..565151,
        564295..565140, 564287, 564269..564280, 564253..564261, 564246..564248,
        564212..564237, 564073..564194, 564044..564061, 563695..564029, 563691,
        563671..563681, 563658..563668, 563654, 563652, 563636..563646, 563623..563624,
        563602..563611, 563590, 563581, 563574..563575, 563562, 563557..563560,
        563553..563554, 563543..563547, 563537, 563522..563535, 563513..563518,
        563495..563503, 563493, 563479, 563472..563475, 563454..563464, 563446,
        563437, 563422, 563404..563414, 563398..563401, 563394..563395, 563375..563387,
        563365..563369, 563358, 563341, 563337, 563333, 563321..563327, 563308..563312,
        563298, 563289..563292, 563286, 563267..563272, 563263, 563256..563257,
        563250, 563245, 563241, 563232, 563217, 563210..563213, 563206, 563198..563201,
        563167..563196, 563150..563162, 563114..563131, 563107..563111, 563095..563100,
        563085, 563077..563083, 563068, 563065, 563047..563052, 563033..563037,
        563025, 563014, 563000..563008, 562995, 562837..562974, 562824..562826,
        562818..562822, 562812..562813, 562805, 562802, 562800, 562793..562796,
        562789..562790, 562787, 562782, 562778, 562772, 562762..562770, 562760,
        562754..562758, 562748..562751, 562743, 562735..562738, 562732, 562730,
        562725..562726, 562721..562722, 562715..562717, 562712, 562710, 562706..562707,
        562698..562699, 562696, 562694, 562691, 562686..562688, 562678..562682,
        562674, 562666, 562660, 562654, 562648..562650, 562645, 562643, 562641,
        562633..562635, 562630, 562627..562628, 562619..562620, 562617, 562613..562614,
        562604, 562601, 562589, 562570..562586, 562563, 562556, 562552, 562547..562548,
        562538..562544, 562531..562534, 562528..562529, 562522..562524, 562517,
        562510..562514, 562505, 562486..562495, 562474, 562469, 562457, 562452..562453,
        562448, 562442..562445, 562438..562439, 562433..562434, 562424..562428,
        562422, 562410, 562398, 562389..562396, 562376..562378, 562370..562371,
        562365, 562360..562362, 562356, 562354, 562342..562350, 562332..562333,
        562324, 562321, 562317, 562306, 562303, 562300, 562297, 562295, 562285..562292,
        562283, 562277..562278, 562271..562273, 562267, 562263..562265, 562255..562260,
        562253, 562250, 562241, 562237..562239, 562233, 562228, 562226, 562222..562223,
        562213..562216, 562211, 562204..562206, 562193..562194, 562189, 562185,
        562181, 562154..562157, 562150, 562147..562148, 562145, 562143, 562138,
        562132, 562128, 562126, 562121, 562112, 562107, 562101, 562081..562086,
        562077, 562069, 562063, 562059..562060, 562043..562056, 562041, 562034..562035,
        562019..562020, 562011..562012, 562006..562007, 561357, 561198..561299,
        561190, 561154, 561150, 561147, 561144, 561091..561125, 561086, 561062,
        561056..561059, 561033, 560974..561003, 560972, 560962..560965, 560955,
        560934, 560917..560927, 560910..560911, 560896, 560847..560854, 560823..560841,
        560820..560821, 560801..560808, 560778..560789, 560751..560767, 560706..560740,
        560692..560693, 560687..560689, 560672..560681, 560657..560664, 560625..560634,
        560619, 560565..560592, 560540..560548, 560524..560528, 560497..560518,
        560465..560471, 560451..560460, 560287..560444, 560230..560280, 560220..560227,
        560201, 560182..560194, 560166..560172, 560162, 560144..560155, 560114..560138,
        560101, 560072..560085, 560058..560069, 560048..560054, 560039..560045,
        560034, 560000..560030, 554563, 553103, 508960..508999, 508950..508958,
        508945..508948, 508926..508943, 508923..508924, 508919..508921, 508902..508917,
        508898..508900, 508885..508896, 508866..508883, 508862..508864, 508857..508860,
        508855, 508844..508853, 508834..508841, 508831, 508807..508827, 508804..508805,
        508802, 508782..508800, 508756..508779, 508740..508752, 508736..508737,
        508727..508734, 508723..508725, 508710..508721, 508701..508708, 508698..508699,
        508692..508696, 508684..508690, 508676..508682, 508674, 508670..508672,
        508657..508668, 508645..508655, 508637..508643, 508628..508635, 508620..508626,
        508618, 508615, 508613, 508609, 508604..508606, 508599..508602, 508588..508595,
        508586, 508574..508584, 508571..508572, 508569, 508558..508567, 508552..508556,
        508550, 508545, 508539, 508535..508536, 508531, 508529, 508527, 508524..508525,
        508517..508522, 508513..508514, 508511, 508509, 508503..508504, 508198..508406,
        508186..508195, 508165..508182, 508155..508163, 508144..508153, 508113..508142,
        507861..508111, 507731..507859, 506779..507728, 506433..506698, 506431,
        506411..506429, 506394..506409, 506370..506392, 506358..506368, 506354..506356,
        506344..506352, 506341..506342, 506337..506338, 506333..506335, 506330..506331,
        506321..506328, 506314..506317, 506310, 506307..506308, 506304..506305,
        506298, 506284..506296, 506282, 506275, 506270..506271, 506266..506268,
        506264, 506260..506261, 506256, 506252, 506248..506249, 506246, 506238..506244,
        506229..506236, 506223..506227, 506218..506220, 506216, 506213, 506204..506211,
        506200, 506085..506198, 506075..506082, 506064..506072, 506062, 506048..506060,
        506043..506045, 506031..506041, 506024..506029, 506016..506022, 505820..506014,
        505806..505818, 505804, 505409..505802, 505351..505407, 505108..505349,
        505016..505106, 505012..505014, 504967..505010, 504964..504965, 504953..504962,
        504897..504951, 504895, 504891..504893, 504861..504889, 504848..504857,
        504841..504846, 504837..504839, 504827..504834, 504812..504825, 504806..504809,
        504800..504804, 504792..504798, 504757..504786, 504743..504755, 504735..504741,
        504726..504732, 504724, 504722, 504696..504720, 504676..504693, 504664..504674,
        504660..504662, 504649..504658, 504647, 504645, 504639..504643, 504601..504637,
        504583..504599, 504579..504581, 504557..504577, 504553..504555, 504536..504551,
        504530..504534, 504526..504527, 504490..504524, 504484..504487, 504468..504482,
        504444..504466, 504422..504442, 504413..504420, 504410, 504397..504404,
        504386..504390, 504377..504381, 504367..504374, 504361, 504352, 504340..504344,
        504333, 504326, 504197..504324, 504176..504194, 504134..504174, 504132,
        504109..504129, 504099..504107, 504084..504097, 504032..504082, 504017..504022,
        504013, 504008, 504002..504005, 503998, 503974, 503960, 503951, 503924,
        503922, 503893..503906, 503877..503888, 503864..503875, 503842, 503829,
        503819..503823, 503813, 503792, 503779, 503744..503770, 503724..503728,
        503720..503722, 503712..503717, 503710, 503694..503708, 503688..503692,
        503678..503686, 503672..503676, 503670, 503656..503668, 503652..503654,
        503648..503649, 503641..503646, 503637..503639, 503632..503635, 503624..503630,
        503620..503621, 503615..503618, 503589..503613, 503563..503586, 503537..503559,
        503529..503535, 503524..503527, 503486..503522, 503471..503483, 503458..503469,
        503448..503456, 503441..503445, 503438..503439, 503429..503436, 503358..503426,
        503350..503356, 503340..503348, 503336..503337, 503280..503334, 503272..503278,
        503256..503270, 503245..503254, 503242, 503226..503239, 503222..503223,
        503213..503220, 503196..503211, 503190..503194, 503170..503188, 503154..503168,
        503144..503151, 503139..503141, 503135..503136, 503121..503133, 503106..503119,
        503100..503103, 503054..503098, 503046..503052, 503041..503044, 503038..503039,
        503016..503036, 503012..503014, 502848..503010, 502812..502846, 502802..502810,
        502786..502800, 502781..502782, 502779, 502770..502776, 502766..502767,
        502763..502764, 502759..502761, 502753..502757, 502751, 502749, 502746..502747,
        502742..502744, 502735..502738, 502729..502730, 502722..502727, 502719..502720,
        502713..502717, 502709..502711, 502706..502707, 502692..502704, 502688..502689,
        502681..502686, 502670..502679, 502667, 502629..502665, 502623..502626,
        502615..502621, 502612..502613, 502596..502609, 502594, 502588..502592,
        502576..502585, 502559..502574, 502554..502557, 502551..502552, 502546..502549,
        502540..502544, 502536..502538, 502532..502534, 502528..502530, 502512..502526,
        502510, 502505..502507, 502495..502503, 502490..502493, 502486..502488,
        502475..502484, 502459..502473, 502455..502457, 502442..502453, 502430..502440,
        502411..502428, 502399..502409, 502386..502396, 502384, 502381..502382,
        502379, 502359..502377, 502351..502356, 502329..502349, 502320..502327,
        502311..502318, 502308..502309, 502242..502306, 502199..502240, 502144..502197,
        502028..502142, 502000..502026, 501893..501899, 501876..501891, 501867..501869,
        501864..501865, 501861..501862, 501856..501859, 501853..501854, 501845..501851,
        501841..501842, 501831..501839, 501828..501829, 501825..501826, 501821..501822,
        501818, 501807..501815, 501801..501804, 501789..501799, 501782..501787,
        501759..501779, 501756..501757, 501748..501754, 501741..501746, 501734..501739,
        501621..501732, 501614..501619, 501609..501612, 501598..501607, 501589..501596,
        501581..501587, 501571..501577, 501558..501569, 501549..501556, 501542..501546,
        501532..501539, 501528..501530, 501518..501526, 501495..501516, 501493,
        501491, 501477..501489, 501471..501475, 501466..501469, 501463..501464,
        501457..501461, 501452..501455, 501411..501450, 501406..501409, 501397..501403,
        501383..501395, 501373..501381, 501362..501371, 501348..501359, 501345,
        501326..501342, 501322..501323, 501311..501319, 501305..501309, 501302..501303,
        501295..501300, 501280..501292, 501251..501278, 501239..501249, 501234..501237,
        501226..501231, 501215..501224, 501212, 501209..501210, 501201..501207,
        501198..501199, 501185..501196, 501174..501183, 501166..501172, 501159..501163,
        501155..501156, 501150..501151, 501147, 501138..501145, 501135, 501120..501132,
        501086..501118, 501013..501084, 501008..501011, 501005..501006, 500885..501003,
        500861..500883, 500854..500859, 500844..500852, 500838..500842, 500831..500836,
        500819..500829, 500808..500817, 500804..500806, 500792..500802, 500770..500788,
        500752..500768, 500743..500750, 500737..500741, 500728..500735, 500725..500726,
        500718..500722, 500715..500716, 500703..500713, 500694..500701, 500684..500692,
        500670..500682, 500663..500668, 500648..500660, 500636..500645, 500623..500632,
        500619..500621, 500608..500617, 500606, 500590..500604, 500588, 500586,
        500581..500582, 500572..500578, 500554..500570, 500548..500552, 500536..500546,
        500533, 500531, 500524..500529, 500502..500522, 500491..500500, 500486..500489,
        500448..500484, 500441..500446, 500438, 500433..500434, 500419..500431,
        500405..500417, 500377..500403, 500362..500375, 500349..500360, 500307..500345,
        500284..500305, 500276..500282, 500265..500274, 500255..500263, 500245..500252,
        500234..500243, 500223..500232, 500213..500220, 500204..500210, 500186..500202,
        500184, 500179..500182, 500175..500176, 500170, 500162..500168, 500159..500160,
        500157, 500152..500155, 500150, 500146..500148, 500143..500144, 500141,
        500125..500139, 500119..500122, 500110..500117, 500099..500108, 500096,
        500094, 500089..500092, 500087, 500080..500085, 500078, 500073..500075,
        500051..500071, 500045..500048, 500039..500043, 500031..500037, 500026..500028,
        500019..500024, 500013..500015, 500008..500011, 500005..500006, 500000..500003,
        229237..229239
        'intl maestro'
      when 561090, 561065..561084, 561060, 561034..561047, 561013..561025, 561004..561009
        'australian bankcard'
      else
        'unknown'
    end
  end
end
