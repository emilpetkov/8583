module ISO8583

  def self.add_value2text(deserialization_map, value2text_map, string_id)
    return unless value2text_map
    value = deserialization_map[string_id]
    return unless value
    value_info_text = value2text_map[value]
    return unless value_info_text
    text_string_id = "#{string_id}_value2text"
    deserialization_map[ text_string_id ] = value_info_text
  end

  def self.serialize_fixed_subfields(field_number, string_id2subfield, params_hashtable, message)
    identified_subfields = 0
    field_raw_data = ""

    index = 0

    ignore_rest_message_part = false

    string_id2subfield.keys.sort_by { |key| string_id2subfield[key].start_position }.each do
      |subfield_string_id|

      if( index != string_id2subfield[subfield_string_id].start_position )
        raise ArgumentError.new "BM #{field_number}: serializer dont know what data to put on position #{index}. There is a gap in subfields definitions. Next position with definition is #{string_id2subfield[subfield_string_id].start_position}"
      end
      subfield_def = string_id2subfield[ subfield_string_id ]
      subfield_value = params_hashtable[subfield_string_id]
      if( not subfield_value )
        if( subfield_def.mandatory )
          raise ArgumentError.new "BM #{field_number}: Element #{subfield_string_id} is missing from map with values, but it is marked as mandatory"
        end
        # no value & field not mandatory
        index += subfield_def.subfield_length
        ignore_rest_message_part = true
        next
      else
        if( ignore_rest_message_part )
          # we have subfield_value and we are in ignore_rest_message_part mode
          raise ArgumentError.new "BM #{field_number}: Subfield #{subfield_string_id} is filled, but previous subfield was empty, so we could generate an array with gaps"
        else
          # everything is normal here
        end
      end
      encoded_subfield = subfield_def.serialize( subfield_value )

      identified_subfields += params_hashtable[subfield_string_id.to_s+"_value2text"] ? 2 : 1
      field_raw_data += encoded_subfield
      index += subfield_def.subfield_length
     end

    if( identified_subfields != params_hashtable.length )
        raise ArgumentError.new "BM #{field_number} arguments hashmap has unparsed elements. Identified subfields '#{identified_subfields}'. Elements in hashmap: #{params_hashtable.length}"
    end

    field_raw_data
  end

  def self.deserialize_fixed_subfields(field_number, string_id2subfield, raw_src, message)
    result_hashmap = Hash.new
    index = 0
    string_id2subfield.keys.sort_by { |key| string_id2subfield[key].start_position }.each do |subfield_string_id|
      if( index != string_id2subfield[subfield_string_id].start_position )
        raise ArgumentError.new "BM #{field_number}: deserializer dont know what data is lcoated on position #{index}. There is a gap/overlapse in subfields definitions."
      end
      subfield_def = string_id2subfield[ subfield_string_id ]
      if( not subfield_def )
        raise ArgumentError.new "BM #{field_number}: cannot find definition for element #{subfield_string_id}."
      end
      raw_subfield_value = raw_src[ index, subfield_def.subfield_length ]
      subfield_length = subfield_def.deserialize( result_hashmap, raw_subfield_value )
      index += subfield_length
    end
    result_hashmap
  end

  def self.serialize_lllxx_subfields(field_number, string_id2subfield, params_hashtable, message)
    identified_subfields = 0
    field_raw_data = ""

    params_hashtable.keys.sort_by { |key| key.to_s }.each do
      |subfield_string_id|
      subfield_value = params_hashtable[subfield_string_id]
      subfield_def = string_id2subfield[ subfield_string_id ]
      if( subfield_def == nil )
        raise ArgumentError.new "BM #{field_number} Unknown subfield with id '#{subfield_string_id}' and value '#{subfield_value.to_s}'"
      end
      encoded_subfield = subfield_def.serialize( subfield_value )

      identified_subfields += 1
      field_raw_data = field_raw_data + encoded_subfield
     end

    if( identified_subfields != params_hashtable.length )
        raise ArgumentError.new "BM #{field_number} arguments hashmap has unparsed elements. Identified subfields '#{identified_subfields}'. Elements in hashmap: #{params_hashtable.length}"
    end

    field_raw_data
  end

  def self.deserialize_lllxx_subfields(field_number, numeric_id2subfield, raw_src, message)
    result_hashmap = Hash.new
    index = 0
    while index != raw_src.length
      if( (raw_src.length - index) < 5 )
        raise ArgumentError.new "BM #{field_number}, the rest of the raw data is 1 byte, so we cannot get field_id"
      end
      rest = raw_src[ index .. raw_src.length - 1 ]
      subfield_id = raw_src[index+3 .. index+4].to_i
      subfield_def = numeric_id2subfield[ subfield_id ]

      if( subfield_def == nil )
        raise ArgumentError.new "BM #{field_number} Unknown subfield with id '#{subfield_id}', index='#{index}', rest='#{rest}'"
      end

      subfield_length = subfield_def.deserialize( result_hashmap, rest  )
      index += subfield_length # 2 is for the prefix
    end # while

    result_hashmap
  end

  def self.serialize_lll_ebcdic_subfield(additional_data)
    "".force_encoding('ASCII-8BIT').tap do |serialized_string|
      additional_data.each do |name, data|
        # subfield number
        number      = PAYNETICS_SUBFIELD_DEFINITIONS[name][:number]
        subelements = PAYNETICS_SUBFIELD_DEFINITIONS[name][:subelements]
        if !subelements.nil? && !subelements.empty? && data.is_a?(Hash)
          serialized_string << serialize_lll_ebcdic_subelement(subelements, data, number)
        else
          # Encode the length of subfield number + data in EBCDIC
          length = LLL_EBCDIC.encode((number + data).length, nil)
          # Encode the subfield number in EBCDIC
          number = LL_EBCDIC.encode(number, nil)
          # Encode the actual data in the format
          data = PAYNETICS_SUBFIELD_DEFINITIONS[name][:codec].encode(data)
          # Join the encoded length, encoded subfield number and actual data
          encoded_data = length + number + data
          serialized_string << encoded_data
        end
      end
    end
  end

  def self.serialize_lll_ebcdic_subelement(subelements, data, number)
    "".force_encoding('ASCII-8BIT').tap do |serialized_string|
      data.each do |subelement_name, subelement_data|
        length            = number.length
        subelement_number = subelements[subelement_name][:number]
        subelement_length = (subelement_number + subelement_data).length
        serialized_string << "".force_encoding('ASCII-8BIT').tap do |encoded_data_with_subelement|
          # length of the subfield = subfield number length + subelement length + length of the
          # subelement length /const 00X, X = subelement length/
          encoded_data_with_subelement << LLL_EBCDIC.encode(length + subelement_length + PAYNETICS_SUBFIELD_LENGTH_PREFIX, nil)
          encoded_data_with_subelement << LL_EBCDIC.encode(number, nil)
          encoded_data_with_subelement << LLL_EBCDIC.encode(subelement_length, nil)
          encoded_data_with_subelement << LL_EBCDIC.encode(subelement_number, nil)
          encoded_data_with_subelement << subelements[subelement_name][:codec].encode(subelement_data)
        end
      end
    end
  end

  def self.deserialize_lll_ebcdic_subfield(raw_additional_data)
    #\xF0\xF0\xF4 \xF4\xF0\xF0\xF7 \xF0\xF0\xF6 \xF3\xF0\xF0\xF2\xF9\xF9
    # Algorithm to iterate over the serialized fields. Each iteration loops over
    # one serialized field
    {}.tap do |deserialized_fields|
      index = 0
      length_prefix = PAYNETICS_SUBFIELD_LENGTH_PREFIX
      while index < raw_additional_data.length
        # Get the length of the field
        length = ISO8583.ebcdic2ascii(raw_additional_data[index...index + length_prefix]).to_i
        # Get the encoded payload of the field
        data = raw_additional_data[(index + length_prefix)...(index + length_prefix + length)]

        field_number = ISO8583.ebcdic2ascii(data[0, PAYNETICS_SUBFIELD_NUMBER_LENGTH]).to_i
        field_definition = PAYNETICS_SUBFIELD_DEFINITIONS.values.detect { |k, _v| k[:number].to_i == field_number }

        subelements = field_definition[:subelements]
        if !subelements.nil? && !subelements.empty?
          deserialize_lll_ebcdic_subelement(data, subelements, field_definition, deserialized_fields)
        else
          # Decode the payload with the proper codec
          actual_data = field_definition[:codec].decode(data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, data.length])
          # Add the deserialized field to the response object
          deserialized_fields[field_definition[:name]] = actual_data
        end
        # Get the total length of the field and add it to the index for the next iteration
        subfield_length = data.length + length_prefix
        index += subfield_length
      end
    end
  end

  def self.deserialize_lll_ebcdic_subelement(raw_data, subelements, field_definition, deserialized_fields)
    length_prefix = PAYNETICS_SUBFIELD_LENGTH_PREFIX
    data_index    = 0
    sub_data      = raw_data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, raw_data.length]
    while data_index < sub_data.length
      subelement_length     = ISO8583.ebcdic2ascii(sub_data[data_index...data_index + length_prefix]).to_i
      subelement_data       = sub_data[(data_index + length_prefix)...(data_index + length_prefix + subelement_length)]
      subelement_number     = ISO8583.ebcdic2ascii(subelement_data[0, PAYNETICS_SUBFIELD_NUMBER_LENGTH]).to_i
      subelement_definition = subelements.values.detect { |k, _v| k[:number].to_i == subelement_number }
      actual_data           = subelement_definition[:codec].decode(subelement_data[PAYNETICS_SUBFIELD_NUMBER_LENGTH, subelement_data.length])

      deserialized_fields["#{field_definition[:name]}/#{subelement_definition[:name]}"] = actual_data

      data_index += actual_data.length + length_prefix + PAYNETICS_SUBFIELD_NUMBER_LENGTH
    end
  end

  def self.array_to_hashmap_fixed_len(hashmap, hashmap_id, raw_array, start_pos, data_len, field_info)
    if raw_array.length < (start_pos + data_len)
      raise ArgumentError.new("#{field_info}: No space in raw array to src value, arr_len=#{raw_array.length}, data_end_pos=#{start_pos + data_len}")
    end
    hashmap[hashmap_id] = raw_array[start_pos..(start_pos + data_len - 1)]
    start_pos + data_len
  end

  def self.value_to_array(src, raw_array, start_pos, data_len, field_info, mandatory)
    if raw_array.length < (start_pos + data_len)
      raise ArgumentError.new("#{field_info}: No space in raw array to src value, arr_len=#{raw_array.length}, data_end_pos=#{start_pos + data_len}")
    end

    unless src or src.length < 1
      if mandatory
        raise ArgumentError.new("#{field_info}: mandatory field is not filled")
      else
        # just skipping
        return
      end
    end

    if src.length != data_len
      raise ArgumentError.new("#{field_info}: src_field_length=#{src.length}; dst_field_length=#{data_len}; src='#{src}'")
    end

    raw_array[start_pos..(start_pos + data_len - 1)] = src
  end

  def self.xx_value_to_array(raw_array, data_len, subfield_num_id1, subfield_str_id1, field_info1, mandatory)
    if (not raw_array) && (not mandatory)
      return ""
    end

    if( subfield_num_id1 < 0 || subfield_num_id1 > 99 )
      raise ArgumentError.new("#{field_info1} (subfield_id=#{subfield_num_id1}/#{subfield_str_id1}): subfield_id is not in range 00-99")
    end

    subfield_id2 = (subfield_num_id1 < 10 ? "0" : "") + subfield_num_id1.to_s

    field_info2 = (field_info2 ? field_info2 + " " : "") + "(subfield_id=#{subfield_num_id1}/#{subfield_str_id1})"

    if data_len != raw_array.length
      raise ArgumentError.new("#{field_info1} (subfield_id=#{subfield_num_id1}/#{subfield_str_id1}): provided data length(#{raw_array.length}) differs from required length(#{data_len}). Value is '#{raw_array}'")
    end

    subfield_id2 + raw_array
  end

  # TODO - this is crap, needs to use the bin list
  def self.credit_card_brand(number)
    digits = number.to_s[0..5].to_i
    case digits
      when 369989, 369607..369618, 369400..369605, 369210..369215, 369000..369206,
        367071..367092, 367069, 367011..367067, 365400..367002, 365298..365394,
        365217..365256, 365214..365215, 365209..365211, 365106..365207, 365025..365049,
        365000..365023, 364940..364942, 364910..364913, 364900..364905, 364880..364888,
        364833..364878, 364612..364830, 364482..364610, 364441..364480, 364093..364436,
        363999..364091, 363722..363727, 363571, 363549..363550, 363537..363546,
        363527, 363520, 363518, 363490..363494, 363484..363485, 363480..363481,
        363476..363478, 363474, 363470, 363467..363468, 363451..363455, 363448,
        363444..363445, 363439..363440, 363432..363437, 363429..363430, 363425..363427,
        363423, 363421, 363418, 363411..363416, 363402, 363345..363352, 363299..363342,
        363085, 362800, 362611..362636, 362606..362607, 362600..362601, 362563..362564,
        362500..362560, 362392..362433, 362200..362385, 362191..362196, 362065..362142,
        362056..362063, 362046..362053, 361991..362044, 361842..361890, 361801..361840,
        361770..361799, 361760..361767, 361708..361756, 361682..361698, 361650..361680,
        361558, 361349..361513, 361300..361346, 361295..361298, 361261..361273,
        361235..361259, 361218..361233, 361119..361133, 361115..361116, 361070..361080,
        361063, 361019..361021, 361017, 360970..361013, 360935..360966, 360769..360922,
        360708..360764, 360193..360552, 360186..360187, 360021..360181, 360001..360019,
        352800..358999, 333714..334999, 315865..315981, 311200..311881, 309600..310299,
        309100..309499, 213100..213199
        'jcb'
      when 558345..559999, 557993..558343, 557713..557991, 554564..557711, 553104..554562,
        551000..553102, 548855..550998, 534096..548853, 523097..534094, 510000..523095,
        229240..272099, 222100..229236
        'master'
      when 390000, 389925, 389919, 389854, 389820..389821, 389614, 389533, 389496,
        389490, 389389, 389283, 389249, 389183, 389151..389152, 389035, 388999,
        388961, 388922, 388893, 388831, 388823, 388797, 388750, 388712, 388681,
        388658, 388650, 388642, 388594, 388574..388579, 388554, 388549, 388526,
        388507, 388502, 388500, 388467, 388455, 388429, 388403, 388380, 388294,
        388288, 388153, 388150, 388121, 388106, 388099, 388080, 388010, 387999,
        387900, 387830, 387815, 387805, 387800, 387748, 387744, 387715, 387674,
        387614, 387601, 387501, 387483, 387467, 387421, 387401, 387398, 387368,
        387363, 387330, 387280, 387248, 387208, 386999, 386990, 386830..386831,
        386819, 386767, 386759, 386726, 386628, 386502, 386457, 386436, 386273,
        386208, 386183, 386172, 386163, 386136, 386098, 386080, 386062, 385999..386000,
        385987, 385928, 385878, 385841, 385716, 385660, 385598, 385591, 385576,
        385546, 385490, 385463, 385446, 385437, 385365, 385283, 385207, 385200..385201,
        385181, 385153, 385085, 385062, 385048, 385030, 385026, 385020, 385002..385003,
        384999..385000, 384988, 384943, 384930, 384920, 384899, 384868, 384830,
        384783, 384777, 384699, 384669..384670, 384622, 384599, 384546, 384499,
        384430, 384399, 384384, 384358, 384336, 384328, 384250..384251, 384225,
        384170, 384120, 384109..384110, 384102, 384096, 384015, 383999..384000,
        383932, 383799, 383758, 383736, 383371, 383356, 383353, 383228, 383182,
        383153, 382999..383001, 382980, 382965, 382944, 382886, 382814, 382797..382799,
        382794, 382792, 382790, 382773, 382764, 382750, 382737, 382702, 382699,
        382674, 382528, 382503, 382499, 382457, 382335, 382299, 382284, 382199,
        382105, 382033, 381999, 381935, 381815, 381750, 381741, 381559, 381537,
        381424, 381379, 381226, 381200, 381185, 381134, 381026, 381024, 380999..381000,
        380989, 380971, 380902, 380899, 380804, 380787, 380727, 380714, 380546,
        380537, 380511, 380505..380507, 380499, 380393, 380208, 380174, 380172,
        380166, 380126, 380099, 380089..380095, 380059, 380054, 380046, 380039,
        380020, 369990..369999, 369684..369988, 369606, 369216..369399, 369207..369209,
        367093..368999, 367070, 367068, 367003..367010, 365395..365399, 365257..365297,
        365216, 365212..365213, 365208, 365050..365105, 365024, 364943..364999,
        364914..364939, 364906..364909, 364889..364899, 364879, 364831..364832,
        364611, 364481, 364437..364440, 364092, 363728..363998, 363572..363721,
        363551..363570, 363547..363548, 363528..363536, 363521..363526, 363519,
        363495..363517, 363486..363489, 363482..363483, 363479, 363475, 363471..363473,
        363469, 363456..363466, 363449..363450, 363446..363447, 363441..363443,
        363438, 363431, 363428, 363424, 363422, 363419..363420, 363417, 363403..363410,
        363353..363401, 363343..363344, 363086..363298, 362801..363084, 362637..362799,
        362608..362610, 362602..362605, 362565..362599, 362561..362562, 362434..362499,
        362386..362391, 362197..362199, 362143..362190, 362064, 362054..362055,
        362045, 361891..361990, 361841, 361800, 361768..361769, 361757..361759,
        361699..361707, 361681, 361559..361649, 361514..361557, 361347..361348,
        361299, 361274..361294, 361260, 361234, 361134..361217, 361117..361118,
        361081..361114, 361064..361069, 361022..361062, 361018, 361014..361016,
        360967..360969, 360923..360934, 360765..360768, 360553..360707, 360188..360192,
        360182..360185, 360020, 360000, 337970..339704, 337940, 335489..337852,
        333355..333601, 330280..333326, 330010..330060, 328186..329794, 324222..328000,
        320639..323866, 320000..320523, 317215..319696, 316123..317155, 314711..315616,
        312319..313838, 311183, 311111, 310441..311000, 309500..309599, 300000..305999
        'diners'
      when 379970..379999, 377175..379965, 377170..377173, 376900..377168, 376860..376878,
        376857..376858, 376630..376799, 376555..376599, 376532..376541, 376510..376519,
        376500..376501, 376468..376469, 376450..376460, 375523..376419, 375181..375521,
        375140..375176, 374778..375129, 374766, 374733..374757, 374730, 370936..374727,
        370913..370934, 370607..370911, 370505..370605, 370461..370503, 370352..370459,
        370350, 370181..370348, 370167..370178, 370019..370165, 370005..370017, 370003,
        370000..370001, 349917..349999, 349912..349915, 349841..349910, 349495..349839,
        349392..349493, 349326..349390, 349209..349324, 349160..349207, 349077..349158,
        348581..349075, 347778..348579, 347643..347776, 347301..347641, 347290..347299,
        346778..347288, 346668..346776, 346603..346666, 346553..346601, 346523..346551,
        346489..346521, 346485..346486, 346476..346482, 346469..346474, 346450..346467,
        346447..346448, 346443..346445, 346439..346441, 346437, 345877..346435, 345801..345875,
        345563..345799, 345535..345561, 345430..345533, 345419..345428, 345412..345417,
        345380..345410, 345158..345378, 344996..345155, 344761..344994, 344732..344759,
        344676..344730, 344577..344674, 344335..344575, 344295..344333, 344135..344293,
        344126..344133, 344025..344124, 343914..344023, 343569..343912, 343335..343567,
        343255..343333, 343001..343253, 342768..342999, 342588..342766, 342575..342586,
        342568..342573, 342355..342566, 342138..342353, 342031..342136, 341864..342029,
        341817..341862, 341618..341815, 341557..341616, 341169..341555, 340955..341167,
        340666..340953, 340394..340664, 340326..340392, 340218..340324, 340000..340216,
        337941, 337912..337913, 324000
        'amex'
      when 652891..659999, 652884..652889, 652879..652882, 652875..652876, 652871..652872,
        652868..652869, 652857, 652401..652849, 652307..652399, 652282..652305,
        652280, 652269..652277, 652267, 652224, 652222, 652167, 644000..652149,
        601300, 601100..601199, 390001..399999, 389926..389999, 389920..389924,
        389855..389918, 389822..389853, 389615..389819, 389534..389613, 389497..389532,
        389491..389495, 389390..389489, 389284..389388, 389250..389282, 389184..389248,
        389153..389182, 389036..389150, 389000..389034, 388962..388998, 388923..388960,
        388894..388921, 388832..388892, 388824..388830, 388798..388822, 388751..388796,
        388713..388749, 388682..388711, 388659..388680, 388651..388657, 388643..388649,
        388595..388641, 388580..388593, 388555..388573, 388550..388553, 388527..388548,
        388508..388525, 388503..388506, 388501, 388468..388499, 388456..388466,
        388430..388454, 388404..388428, 388381..388402, 388295..388379, 388289..388293,
        388154..388287, 388151..388152, 388122..388149, 388107..388120, 388100..388105,
        388081..388098, 388011..388079, 388000..388009, 387901..387998, 387831..387899,
        387816..387829, 387806..387814, 387801..387804, 387749..387799, 387745..387747,
        387716..387743, 387675..387714, 387615..387673, 387602..387613, 387502..387600,
        387484..387500, 387468..387482, 387422..387466, 387402..387420, 387399..387400,
        387369..387397, 387364..387367, 387331..387362, 387281..387329, 387249..387279,
        387209..387247, 387000..387207, 386991..386998, 386832..386989, 386820..386829,
        386768..386818, 386760..386766, 386727..386758, 386629..386725, 386503..386627,
        386458..386501, 386437..386456, 386274..386435, 386209..386272, 386184..386207,
        386173..386182, 386164..386171, 386137..386162, 386099..386135, 386081..386097,
        386063..386079, 386001..386061, 385988..385998, 385929..385986, 385879..385927,
        385842..385877, 385717..385840, 385661..385715, 385599..385659, 385592..385597,
        385577..385590, 385547..385575, 385491..385545, 385464..385489, 385447..385462,
        385438..385445, 385366..385436, 385284..385364, 385208..385282, 385202..385206,
        385182..385199, 385154..385180, 385086..385152, 385063..385084, 385049..385061,
        385031..385047, 385027..385029, 385021..385025, 385004..385019, 385001,
        384989..384998, 384944..384987, 384931..384942, 384921..384929, 384900..384919,
        384869..384898, 384831..384867, 384784..384829, 384778..384782, 384700..384776,
        384671..384698, 384623..384668, 384600..384621, 384547..384598, 384500..384545,
        384431..384498, 384400..384429, 384385..384398, 384359..384383, 384337..384357,
        384329..384335, 384252..384327, 384226..384249, 384171..384224, 384161..384169,
        384141..384159, 384121..384139, 384111..384119, 384103..384108, 384101,
        384097..384099, 384016..384095, 384001..384014, 383933..383998, 383800..383931,
        383759..383798, 383737..383757, 383372..383735, 383357..383370, 383354..383355,
        383229..383352, 383183..383227, 383154..383181, 383002..383152, 382981..382998,
        382966..382979, 382945..382964, 382887..382943, 382815..382885, 382800..382813,
        382795..382796, 382793, 382791, 382774..382789, 382765..382772, 382751..382763,
        382738..382749, 382703..382736, 382700..382701, 382675..382698, 382529..382673,
        382504..382527, 382500..382502, 382458..382498, 382336..382456, 382300..382334,
        382285..382298, 382200..382283, 382106..382198, 382034..382104, 382000..382032,
        381936..381998, 381816..381934, 381751..381814, 381742..381749, 381560..381740,
        381538..381558, 381425..381536, 381380..381423, 381227..381378, 381201..381225,
        381186..381199, 381135..381184, 381027..381133, 381025, 381001..381023,
        380990..380998, 380972..380988, 380903..380970, 380900..380901, 380805..380898,
        380788..380803, 380728..380786, 380715..380726, 380547..380713, 380538..380545,
        380512..380536, 380508..380510, 380500..380504, 380394..380498, 380209..380392,
        380175..380207, 380173, 380167..380171, 380127..380165, 380100..380125,
        380096..380098, 380060..380088, 380055..380058, 380047..380053, 380040..380045,
        380021..380038, 380000..380019
        'discover'
      when 457100..457199, 457633..499999, 457394..457630, 457200..457392, 451417..457099,
        438936..451415, 431275..438934, 401180..431273, 400000..401177
        'visa'
      when 990015, 689099..690149, 685140, 685068..685100, 684168..684964, 684055..684080,
        683454..683945, 683050, 682181..682656, 681870..682015, 681790, 681681,
        681450..681549, 681095..681363, 680618..680910, 680501..680571, 680214,
        680072..680156, 679835..680000, 679557..679762, 679291..679550, 679129..679250,
        679126, 679119..679123, 679091..679116, 679025..679089, 679015..679017,
        678975..679012, 678425..678945, 678213..678400, 677856..678203, 677256..677820,
        676818..677254, 676696..676816, 676455..676690, 676414..676452, 676411..676412,
        676351..676408, 676346..676349, 676280..676344, 676267..676278, 676047..676265,
        676036..676038, 675900..676002, 675070..675856, 674362..675058, 673920..674360,
        673899, 673680..673863, 673387..673675, 673047..673377, 673041..673042,
        672801..673004, 672701..672799, 671718..672699, 671583..671681, 671560,
        671496..671501, 671144..671402, 670961..671138, 670944, 669869..670911,
        669672, 669494..669582, 669235, 668830..669038, 668700..668761, 668668,
        668465..668503, 668399, 668327..668345, 667645..668020, 667636, 667512..667531,
        667460, 667295..667305, 667230, 667207, 667100, 666887..667051, 666680..666739,
        666665, 666655, 666496..666554, 666414..666442, 666282..666400, 665942..666099,
        665531..665722, 665097..665467, 665012, 664463..664765, 664386, 664260,
        664090..664096, 663921, 663834, 663639..663726, 663205..663329, 642011..642012,
        639650, 639645, 639597..639623, 639450, 639390..639406, 639362..639372,
        639358, 639300, 639248, 639231..639240, 639212..639213, 639199, 639174,
        639161..639170, 639151, 639139, 638564..639130, 638101..638216, 637780,
        637556, 637217..637369, 637192, 637102, 637074, 636937..637043, 636842..636868,
        636392, 636325, 636101, 633845..636078, 633698..633817, 633641..633675,
        633300..633513, 633174, 633110, 630114..630499, 629451, 628181, 627992,
        627791..627799, 627787..627789, 627781..627784, 627768..627779, 627764..627766,
        627752..627762, 627747..627750, 627741..627745, 627737..627739, 627726..627735,
        627710..627724, 627701..627708, 627692, 627665, 627598, 627568, 627462,
        627421, 627364, 627358, 627252, 627240, 623000, 622989..622998, 622986,
        622982..622983, 622977..622980, 622975, 622971..622973, 622967..622968,
        622959..622963, 622957, 622955, 622949..622953, 622945..622947, 622942..622943,
        622935..622940, 622932..622933, 622433, 622106, 622072, 621984..621986,
        621409, 621055, 621019, 620272, 616788..620009, 606801, 606444..606445,
        606436, 606394..606395, 606389, 606385..606386, 606374, 606349, 606339,
        606337, 606329, 606321, 606284..606285, 606280, 606269, 606263, 606260,
        606252, 606238, 606236, 606233, 606228, 606224, 606209, 606200, 606179,
        606172, 606166, 606144..606145, 606124..606126, 606114, 606090..606099,
        606084..606088, 606082, 606072..606080, 606062..606070, 606053..606060,
        606046..606051, 606032..606044, 606000..606030, 605027..605036, 605007,
        605000, 604972..604983, 604938..604948, 604918, 604906, 604863, 604851..604852,
        604817, 604809, 604776, 604636..604678, 604622, 604426..604612, 604423..604424,
        604400..604421, 604341, 604332, 604327, 604319, 604316..604317, 604249..604299,
        604216..604247, 604203, 603959..604199, 603951, 603913..603948, 603868,
        603841, 603797, 603788, 603763..603778, 603733, 603717, 603690..603692,
        603688, 603681, 603649, 603628, 603614, 603602..603605, 603600, 603590..603591,
        603588, 603574, 603527..603529, 603505, 603494, 603492, 603475..603480,
        603445, 603420, 603409, 603399, 603395..603397, 603378..603383, 603353,
        603346, 603342..603344, 603335..603340, 603325, 603311..603316, 603301,
        603298, 603283, 603246, 603232, 603213, 603198, 603182, 603148, 603134,
        603125..603128, 603120, 603111, 603098, 603054, 602981, 602970, 602908,
        602871, 602676..602678, 602073, 602011..602039, 601993, 601976, 601912,
        601880..601887, 601840, 601689..601699, 601687, 601678..601684, 601676,
        601673..601674, 601670..601671, 601665..601668, 601661..601663, 601659,
        601654..601657, 601640..601652, 601633..601635, 601629..601631, 601619..601627,
        601616..601617, 601594..601613, 601532, 601518..601519, 601500, 601493,
        601451, 601441, 601428, 601422, 601404, 601377, 601354..601356, 601344..601345,
        601291..601299, 601289, 601286, 601281..601284, 601279, 601256..601276,
        601232..601254, 601228..601230, 601214..601226, 601209..601212, 601206,
        601201..601203, 601070, 601039..601050, 601021, 600989..600990, 600852,
        600833, 600384..600386, 600364..600382, 600337..600362, 600316..600335,
        600297..600314, 600292..600295, 600208, 596772..599900, 591261..596770,
        589998..591259, 589993, 589986..589991, 589978..589979, 589976, 589970..589974,
        589966..589967, 589952..589964, 589942..589949, 589940, 589936..589937,
        589925..589934, 589923, 589921, 589917..589919, 589910..589915, 589908,
        589905..589906, 589902, 589899..589900, 589896..589897, 589891..589894,
        589888..589889, 589884..589886, 589877..589878, 589875, 589872..589873,
        589869..589870, 589866..589867, 589861..589864, 589857, 589853..589855,
        589851, 589842..589849, 589837..589839, 589834, 589824..589826, 589818..589822,
        589813..589816, 589811, 589809, 589806, 589804, 589802, 589797..589800,
        589791..589793, 589783..589789, 589776..589779, 589748..589764, 589744,
        589725..589729, 589719..589721, 589711..589713, 589709, 589706, 589700..589703,
        589687, 589681, 589677, 589674, 589658..589665, 589653..589654, 589647,
        589642, 589636..589638, 589632, 589629, 589620, 589602..589613, 589587..589594,
        589562, 589558, 589548..589553, 589531, 589527, 589525, 589505..589506,
        589500, 589491..589492, 589477, 589471, 589452..589465, 589446..589447,
        589434, 589429..589430, 589425, 589416..589418, 589412, 589407, 589399,
        589387, 589379..589382, 589367..589373, 589365, 589360, 589339..589346,
        589325, 589318..589321, 589304..589311, 589297..589298, 589295, 589292,
        589283..589288, 589274, 589267..589271, 589261..589265, 589256, 589241..589246,
        589227..589231, 589221..589222, 589215..589217, 589208..589213, 589200,
        589165..589170, 589160..589161, 589153, 589136, 589128..589131, 589121,
        589117, 589111, 589107, 589099..589101, 589086, 589082..589084, 589077,
        589068, 589048, 589044, 589036, 589018..589028, 589014, 589004..589005,
        588998, 588991..588992, 588984, 588975, 588967..588968, 588951..588961,
        588934, 588916, 588910..588913, 588902, 588900, 588897, 588895, 588890,
        588879, 588871, 588855..588859, 588850..588851, 588846..588848, 588843,
        588836, 588829..588832, 588826, 588812..588821, 588803, 588785..588792,
        588771..588772, 588739, 588734, 588731..588732, 588720, 588698..588701,
        588691, 588675, 588665, 588656..588657, 588652, 588644, 588639, 588620,
        588597..588602, 588580, 588570, 588540, 588480, 588473, 588455, 588429,
        588414, 588407, 588353, 588351, 588330, 588292..588295, 588274, 588270,
        588260, 588227, 588216, 588158, 588106, 588066, 587981, 587954, 587907..587908,
        587901, 587896, 587799, 587769..587770, 587752, 587736, 587722, 587676,
        587654, 587644, 587612, 587545, 587514, 587483, 587456, 587452, 587425,
        587416, 587408, 587339..587340, 587337, 587334..587335, 587331..587332,
        587309, 587288, 587239, 587218, 587120, 586957..586958, 586933, 586923,
        586912, 586906, 586896, 586871, 586865, 586852, 586824, 586805..586806,
        586800, 586792, 586778, 586769, 586753, 586739, 586735, 586714, 586673,
        586668, 586666, 586614, 586598, 586552, 586518, 586509, 586475, 586402,
        586364, 586353, 586314, 586270, 586242, 586235, 586143, 586113, 586107,
        586104, 586100, 586062..586064, 586032, 586010, 585988, 585949..585968,
        585901..585947, 585863, 585847, 585837, 585833, 585830, 585822, 585816..585817,
        585800, 585753..585757, 585720, 585697, 585683..585688, 585680, 585651,
        585624, 585609, 585500..585596, 585496, 585492..585493, 585490, 585487,
        585483, 585477..585478, 585471, 585466..585467, 585453, 585450, 585447,
        585442..585445, 585435, 585430, 585428, 585421, 585419, 585415, 585412,
        585409..585410, 585400, 585393, 585388, 585382, 585351, 585316..585320,
        585297..585298, 585294, 585292, 585281, 585266..585268, 585256, 585253,
        585200..585213, 585183, 585178, 585144, 585050, 584960, 584922, 584911,
        584906, 584848, 584807, 584802, 584769, 584757, 584715, 584649, 584646,
        584637, 584633, 584613, 584593, 584573, 584534, 584503, 584456, 584403,
        584346, 584329, 584309, 584298, 584285, 584269, 584262, 584258, 584246,
        584228, 584214..584216, 584207, 584147, 584144, 584111, 584101, 584016,
        584010, 584001..584007, 583883, 583874, 583805, 583756, 583743, 583697,
        583648, 583599, 583519, 583452, 583448, 583427, 583378, 583325, 583313,
        583310, 583302, 583242, 583195, 583151, 583124, 583103..583104, 583085,
        583004, 582963, 582953, 582941, 582930, 582920, 582908..582912, 582856,
        582782, 582657, 582651, 582635, 582581, 582565, 582548, 582531, 582505,
        582485, 582479, 582473, 582463, 582450, 582342, 582300, 582282, 582243,
        582227, 582218, 582134, 582125, 582117, 582113, 582100..582103, 582096,
        582077, 582065, 582048, 582045, 582013, 582000..582001, 581928, 581915,
        581890, 581867..581880, 581840..581847, 581802..581806, 581753..581800,
        581700..581751, 581698, 581681, 581675, 581650, 581645, 581642, 581635,
        581629, 581609..581610, 581583, 581523, 581517, 581505, 581493, 581471,
        581461, 581454..581455, 581446, 581436, 581425, 581399, 581396, 581389,
        581379..581386, 581363, 581358..581359, 581335, 581314, 581277, 581271,
        581256, 581218, 581195, 581157, 581151, 581149, 581090..581100, 581072,
        581003..581060, 580972..580980, 580937..580960, 580911..580916, 580904,
        580817..580828, 580715..580746, 580697, 580642, 580612..580628, 580539..580601,
        580505..580512, 580493, 580440..580454, 580414..580420, 580349, 580334,
        580313, 580287..580295, 580272, 580260, 580240..580244, 580231, 580210,
        580190, 580155..580160, 580151, 580148..580149, 580120, 580110, 580100,
        580087, 580073, 580063, 580034, 580028..580031, 580023, 580016..580019,
        580001..580002, 579990..579999, 579974..579988, 579942..579972, 579932..579938,
        579923..579928, 579903, 579891..579895, 579878..579886, 579867..579876,
        579813..579821, 579772..579803, 579762, 579742, 579723..579726, 579720,
        579689, 579664, 579641, 579620, 579525, 579395, 579390, 579359, 579284,
        579123, 579100, 579095, 579060, 579055, 578990..579002, 578980..578984,
        578969, 578964, 578946, 578920..578937, 578888..578901, 578817..578853,
        578791, 578765..578788, 578761, 578724, 578662..578694, 578633..578654,
        578600..578614, 578573, 578471..578541, 578456, 578434, 578364..578426,
        578255, 578234, 578214, 578212, 578180, 578164, 578096, 578087, 578058,
        578053, 578020, 577920, 577881, 577854, 577845, 577807, 577805, 577770,
        577757, 577737, 577710, 577706, 577638, 577632, 577597, 577588, 577520,
        577503, 577496, 577446, 577438, 577412, 577349, 577281, 577176, 577129,
        577100..577101, 577042, 577021, 576945..576987, 576925, 576880..576921,
        576875, 576843..576847, 576789..576827, 576709..576743, 576616..576682,
        576588, 576543..576565, 576507, 576462..576485, 576446..576451, 576436..576437,
        576361..576416, 576319, 576230..576283, 576217..576220, 576196..576211,
        576018..576135, 576002, 575920..575973, 575849..575912, 575836..575843,
        575809, 575797, 575770..575771, 575751, 575730, 575712, 575690, 575670..575675,
        575663, 575632, 575576..575578, 575500, 575488, 575477, 575453..575456,
        575449..575450, 575438, 575435, 575427, 575300..575302, 575287, 575280,
        575243..575245, 575184, 575141, 575128..575131, 575112..575117, 575105,
        575080, 575039, 575000..575003, 574957, 574923, 574898..574903, 574894,
        574885..574887, 574850, 574843, 574791, 574714..574740, 574672, 574625,
        574564, 574478..574497, 574464..574475, 574441, 574411, 574343..574357,
        574324..574332, 574263..574266, 574257, 574250, 574234, 574217..574226,
        574211, 574206, 574172, 574165, 574143..574153, 574131, 574128, 574108,
        574085..574100, 574050, 574029, 574001, 573951, 573941, 573905, 573877,
        573860..573863, 573837, 573822, 573785, 573770..573773, 573739..573742,
        573702..573706, 573689, 573684, 573677, 573615, 573605, 573593, 573570,
        573550, 573536..573540, 573495..573513, 573490, 573458..573460, 573448,
        573443, 573429, 573388, 573373, 573330, 573283, 573278, 573217, 573183,
        573149..573162, 573099..573101, 573089, 573067, 573039, 573037, 573024,
        573000..573003, 572968, 572937..572944, 572869, 572838, 572828, 572815..572819,
        572787, 572774, 572744, 572734, 572642, 572625..572626, 572610, 572602,
        572542, 572515, 572496..572511, 572489, 572409..572410, 572402..572406,
        572389, 572346..572352, 572332, 572325, 572284..572310, 572261, 572251,
        572226, 572201, 572196, 572188..572190, 572022, 571968..571969, 571930..571931,
        571904, 571890, 571884, 571852..571871, 571837, 571813, 571810, 571750,
        571722, 571690..571702, 571615, 571591, 571581, 571563..571565, 571542,
        571527, 571512..571513, 571505, 571501, 571456..571459, 571432..571444,
        571392..571407, 571353, 571334..571336, 571315..571316, 571312..571313,
        571306, 571261, 571231..571233, 571210..571216, 571201, 571175..571176,
        571167, 571134..571150, 571114, 571100, 571081, 571040, 571037, 571010,
        570982, 570947, 570917, 570907, 570888, 570874, 570865, 570758, 570746,
        570711..570723, 570700..570701, 570673, 570598, 570525..570545, 570519,
        570498, 570477..570486, 570458..570460, 570453, 570442..570445, 570423,
        570413, 570388, 570373..570376, 570313, 570287, 570255, 570243, 570234..570236,
        570212, 570182, 570155, 570132..570145, 570123..570129, 570100, 570086,
        570066, 570062, 570033..570042, 570028..570031, 570025, 570021, 570016,
        570011..570012, 570009, 570001..570004, 569934..569994, 569899..569920,
        569878..569889, 569830..569874, 569647..569825, 569606..569616, 569510..569599,
        569469..569478, 568954..569365, 568912..568952, 568900..568903, 568830..568887,
        568741..568799, 568700..568712, 568660..568689, 568635, 568566, 568544,
        568535, 568499, 568479, 568462, 568327, 568309, 568228, 568172, 568149,
        568145, 568050..568053, 567956, 567952, 567950, 567935, 567914, 567898,
        567889, 567852, 567850, 567839, 567821, 567809, 567800, 567793, 567788,
        567656, 567653, 567634, 567628, 567497, 567453, 567438..567439, 567434..567436,
        567386..567387, 567359..567360, 567340, 567265, 567228, 567203, 567183,
        567172, 567112, 567097, 567040, 567029, 567011, 567000, 566938..566940,
        566914, 566898, 566810, 566778, 566774, 566769, 566734, 566726, 566677,
        566666, 566655..566657, 566604, 566564, 566557, 566540, 566468, 566454,
        566451, 566413..566414, 566375, 566347, 566309, 566260, 566218, 566174,
        566165..566166, 566160..566161, 566150, 566102..566131, 566061, 565985,
        565901..565950, 565896, 565768..565885, 565713, 565616..565695, 565606,
        565546..565600, 565478..565487, 565455..565468, 565432..565445, 565321..565354,
        565278, 565262..565264, 565227, 565224, 565218, 565207, 565204, 565101,
        564996..565001, 564975..564986, 564888..564943, 564787..564872, 564664..564766,
        564577..564655, 564556..564564, 564547, 564447..564540, 564419..564432,
        564400..564411, 564394, 564380, 564378, 564352..564357, 564345..564347,
        564340, 564322..564323, 564287, 564280, 564261, 564254, 564246..564248,
        564212, 564167..564194, 564160..564162, 564155, 564147..564148, 564125..564137,
        564077..564120, 564073, 564005..564023, 563973..563998, 563886..563916,
        563842..563857, 563774..563823, 563747, 563701..563738, 563681, 563672,
        563665..563666, 563652, 563641..563645, 563574..563575, 563557, 563546..563547,
        563543, 563535, 563513..563518, 563475, 563422, 563414, 563404..563410,
        563358, 563327, 563321, 563289, 563245, 563210..563212, 563150, 563124,
        563114..563120, 563110, 563100, 563085, 563081, 563051, 563037, 563006..563008,
        562870..562974, 562837..562844, 562726, 562707, 562698, 562687, 562666,
        562601, 562570, 562548, 562510, 562469, 562433, 562378, 562356, 562354,
        562347, 562333, 562324, 562300, 562283, 562263, 562225, 562208, 562202,
        562197, 562139, 562099, 562093, 562049, 562014, 562001, 561781..561963,
        561602..561757, 561516..561540, 561464..561488, 561422..561455, 561409,
        561367, 561320..561356, 561271..561299, 561200..561269, 561124, 561111,
        561070, 561054..561059, 561042..561046, 561027..561033, 561020, 561010..561011,
        561003, 561000, 560987, 560980, 560900, 560882..560886, 560855..560856,
        560851, 560829, 560801, 560751, 560709..560740, 560663, 560625..560628,
        560576, 560565, 560540..560548, 560524, 560510, 560470, 560423, 560408..560412,
        560396..560400, 560291..560393, 560280, 560255..560278, 560251..560253,
        560230..560232, 560226, 560220..560224, 560201, 560192, 560182, 560166,
        560162, 560149..560152, 560146, 560130, 560127, 560114, 560101, 560076,
        560065, 560042..560045, 560025, 560000..560016, 554563, 508985, 508900,
        508858, 508785, 508580, 508550, 508535, 508513, 508491, 508486, 508473,
        508449..508450, 508446, 508420, 508418, 508406, 508327, 508293..508294,
        508250, 508243..508248, 508241, 508236, 508233..508234, 508207, 508202,
        508194, 508190, 508188, 508160, 508155, 508150, 508144..508145, 508140,
        508129, 508127, 508124, 508122, 508114, 508102..508103, 508100, 508098,
        508052, 508046, 508036, 508021, 508001, 507993, 507951, 507907, 507886,
        507881, 507866, 507861, 507857, 507850..507851, 507846, 507800, 507642,
        507629, 507623, 507604..507605, 507597, 507581..507582, 507535, 507505,
        507502, 507497..507498, 507479, 507473, 507463, 507457, 507450, 507324,
        507302, 507293, 507272, 507270, 507211, 507109, 507100, 507089..507092,
        507082, 507074, 507062, 507049, 507046, 507040..507041, 507025, 507015..507016,
        507009..507010, 507004, 507001..507002, 506997, 506982, 506968, 506965,
        506849, 506804, 506683, 506668..506669, 506661, 506655, 506652, 506630,
        506623, 506615, 506612, 506606, 506565, 506543, 506512..506514, 506500,
        506482, 506454, 506338, 506307..506308, 506304..506305, 506291..506296,
        506284..506287, 506282, 506275, 506270, 506266..506267, 506264, 506261,
        506249, 506239..506242, 506236, 506232, 506230, 506213, 506210, 506208,
        506205, 506200, 506168, 506155, 506147, 506120..506128, 506115..506118,
        506102..506110, 506100, 506095, 506005, 506003, 506000..506001, 505998,
        505989, 505987, 505978, 505941, 505900, 505888, 505874, 505862, 505857,
        505855, 505850, 505832, 505827, 505825, 505823, 505816, 505812, 505804,
        505800, 505793, 505791, 505785, 505780, 505777, 505751, 505706, 505678,
        505643, 505625..505626, 505613, 505599, 505590, 505552, 505550, 505535,
        505512..505513, 505500, 505490, 505488, 505452, 505448, 505443, 505441,
        505433, 505427..505429, 505422, 505353..505354, 505343, 505303, 505291,
        505285, 505272, 505263, 505252, 505250, 505244, 505221, 505211, 505204,
        505200..505201, 505146, 505144, 505120..505121, 505105, 505074, 505018,
        505012, 505009, 505007, 504899, 504897, 504889, 504878, 504871, 504868,
        504853, 504850, 504820, 504815, 504808, 504793, 504784..504785, 504781,
        504771..504772, 504766, 504755, 504751..504752, 504741, 504738, 504720,
        504716, 504714, 504706, 504696..504697, 504685, 504668, 504656, 504649,
        504642, 504639, 504627..504628, 504620, 504618, 504613, 504611, 504590,
        504559, 504546, 504540, 504536, 504533, 504526, 504506, 504504, 504501,
        504492..504493, 504487, 504468, 504465, 504460, 504458, 504456, 504454,
        504439, 504430, 504423, 504419, 504413, 504410, 504387, 504367, 504342,
        504317..504324, 504310..504313, 504300..504301, 504265..504266, 504260,
        504255, 504241, 504220..504221, 504211, 504208, 504200, 504194, 504189,
        504187, 504182, 504172, 504170, 504168, 504161, 504158, 504140, 504104,
        504100..504101, 503886, 503714, 503699..503700, 503697, 503688..503689,
        503684, 503681, 503670, 503645..503646, 503634, 503629, 503626, 503621,
        503613, 503608..503610, 503606, 503603, 503599..503601, 503595, 503592,
        503589, 503583..503586, 503579, 503574..503575, 503572, 503555, 503526,
        503509, 503503, 503500, 503493, 503487, 503482, 503456, 503449, 503443,
        503441, 503420, 503418, 503413, 503408..503410, 503406, 503400, 503397..503398,
        503393, 503389, 503379, 503375, 503363, 503355, 503348, 503309, 503303,
        503293, 503264, 503247, 503234..503235, 503222, 503205..503206, 503200..503203,
        503183..503184, 503178, 503175, 503171, 503168, 503162..503163, 503131,
        503127, 503124, 503100..503102, 503090, 503051, 503044, 503036, 503034,
        503023, 503002..503003, 502995..502999, 502993, 502990..502991, 502985..502987,
        502980..502981, 502978, 502973..502975, 502966..502971, 502958, 502956,
        502953..502954, 502951, 502948..502949, 502943, 502941, 502937, 502930..502932,
        502924..502926, 502915..502918, 502911..502912, 502908, 502904..502905,
        502900..502901, 502889, 502880, 502849..502851, 502846, 502827, 502822..502825,
        502812, 502810, 502794, 502772, 502767, 502704, 502701, 502657, 502650,
        502623, 502621, 502548, 502544, 502536, 502532..502533, 502528, 502525,
        502523, 502519, 502516, 502513, 502505, 502502, 502500, 502498, 502493,
        502473, 502468, 502463, 502453, 502448..502449, 502444, 502439, 502436,
        502433, 502423, 502419..502420, 502416, 502413, 502406, 502403, 502399,
        502396, 502393, 502391, 502389, 502386, 502375, 502372, 502369, 502366,
        502363, 502359..502360, 502356, 502339, 502321, 502301..502302, 502293,
        502290..502291, 502286, 502282, 502270, 502268, 502262, 502259, 502254,
        502250..502252, 502242, 502237, 502229..502230, 502225, 502219, 502211..502213,
        502206..502207, 502199..502200, 502195, 502192, 502190, 502188, 502181..502182,
        502173, 502170, 502165..502166, 502160, 502150, 502148, 502144, 502142,
        502136, 502130..502134, 502124..502126, 502122, 502119, 502113, 502090..502107,
        502085..502086, 502080..502081, 502075, 502071..502073, 502068..502069,
        502065..502066, 502063, 502056..502061, 502051..502054, 502048..502049,
        502037..502046, 502029..502034, 502023..502025, 502009..502021, 502005,
        502000..502002, 501879, 501876, 501865, 501859, 501853, 501845, 501837,
        501835, 501828, 501811..501812, 501807, 501801..501802, 501799, 501795,
        501777, 501774, 501769, 501765..501767, 501749, 501659, 501651..501655,
        501648..501649, 501637, 501634, 501632, 501629, 501625, 501621..501623,
        501609, 501595, 501539, 501523, 501500, 501477, 501457, 501379, 501369,
        501341..501342, 501337, 501333, 501329, 501327, 501319, 501305..501309,
        501281, 501270, 501262..501263, 501258, 501254, 501235, 501212, 501205,
        501201, 501174, 501170, 501155, 501129, 501122, 501115..501116, 501111,
        501109, 501104..501105, 501102, 501097..501099, 501091, 501087, 501072,
        501063, 501013, 501010, 501008, 501005..501006, 501000..501002, 500994,
        500957, 500953, 500857, 500854, 500845, 500821, 500801..500802, 500797,
        500786, 500783, 500780, 500776, 500768, 500764, 500761..500762, 500758,
        500752, 500745, 500733, 500726, 500719, 500711, 500701, 500698, 500695,
        500690..500691, 500688, 500685, 500677..500678, 500668, 500665, 500654,
        500649, 500627..500628, 500604, 500599..500600, 500568, 500558..500559,
        500502, 500479..500480, 500452, 500416..500417, 500410, 500401, 500378,
        500371..500373, 500365, 500344, 500333, 500330, 500310, 500294..500295,
        500251, 500238, 500234, 500232, 500225, 500216, 500208, 500191, 500187,
        500165..500166, 500163, 500148, 500139, 500122, 500115..500116, 500112,
        500105, 500103, 500094, 500092, 500087, 500081, 500075, 500064, 500062,
        500055..500057, 500053, 500051, 500048, 500043, 500040..500041, 500032,
        500026, 500022, 500020, 500014, 500008..500009, 500005, 229237..229239
        'intl maestro'
      when 561090, 561072..561084, 561065..561069, 561060, 561047, 561034..561041,
        561021..561025, 561013..561018, 561004..561009
        'australian bankcard'
      else
        'unknown'
    end
  end
end
